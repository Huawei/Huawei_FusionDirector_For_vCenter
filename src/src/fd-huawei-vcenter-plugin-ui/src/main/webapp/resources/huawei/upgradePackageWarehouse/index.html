<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>版本仓库</title>
    <link href="../../css/element.css" rel="stylesheet" />
    <link href="../../css/style.css" rel="stylesheet" />
    <script src="../../scripts/vue.js"></script>
    <script src="../../scripts/element.js"></script>
    <script src="../../scripts/jquery-3.2.1.min.js"></script>
    <script src="../../scripts/i18n/zh-CN.js"></script>
    <script src="../../scripts/i18n/en.js"></script>
    <script src="../i18n/en.js"></script>
    <script src="../i18n/zh-CN.js"></script>
    <script src="../../scripts/polyfill.min.js"></script>
    <script src="../js/common.js"></script>
    <script src="../../scripts/web-platform.js"></script>
    <script src="../js/errorCode.js"></script>
    <script src="../../scripts/lodash.min.js"></script>
    <script src="js/rest.js"></script>
    <style>
        [v-cloak] {
            display: none;
        }

        body {
            min-width: 900px;
        }

        /* 部署的下拉搜索框 */
        .input-with-select {
            display: inline-block;
            position: relative;
        }

        .input-with-select .el-select .el-input {
            width: 130px;
        }

        .demo-table-expand {
            font-size: 0;
        }

        .demo-table-expand label {
            width: 120px;
            color: #99a9bf;
        }

        .demo-table-expand .el-form-item {
            margin-right: 0;
            margin-bottom: 0;
            width: 50%;
        }

        .el-progress-bar {
            padding-right: 60px;
            margin-left: -20px;
        }

        .map-row {
            padding: 15px;
            background: #f6f7f8;
            margin: 15px 0;
        }

        .search-row .el-button {
            vertical-align: middle;
        }

        .search-row .el-input-group {
            vertical-align: middle;
        }

        .desLength {
            position: absolute;
            bottom: 0px;
            left: 340px;
            color: #999;
            width: 50px;
            text-align: right;
        }

        .onlineURL {
            display: inline-block;
            position: relative;
            margin: 0 10px;
        }

        .onlineURL i {
            font-size: 18px;
            cursor: pointer;
        }
        .el-icon-success {
            margin-right: 10px;
            color: #409eff;
        }
        .el-icon-error,.el-icon-info {
            margin-right: 10px;
            color: #ff524e;
        }
        .el-icon-edit{
            margin-right: 10px;
        }

        .fdContent {
            position: absolute;
            left: 5px;
            top: 40px;
            z-index: 2;
        }

        .package_table_header .el-checkbox__inner {
            background-color: #edf2fc;
            border-color: #dcdfe6;
            cursor: not-allowed;
        }

        .descript {
            word-break: break-all;
            word-wrap: break-word;
            margin-bottom: 10px;
            display: flex;
        }

        .desctext {
            flex: 1;
        }
    </style>
</head>

<body>
    <div id="app" v-cloak>

        <div>
            <!-- 顶部操作栏 -->
            <el-row class="search-row fdContent" ref="fdContent">
                <el-dropdown @command="commandClick" class="fdBtn">
                    <el-button>
                        {{menuName}}
                        <i class="el-icon-caret-bottom el-icon--right"></i>
                    </el-button>
                    <el-dropdown-menu slot="dropdown">
                        <el-dropdown-item v-for="item in FDs" v-bind:command="item.name" v-bind:key="item.name">
                            {{item.label}}</el-dropdown-item>
                    </el-dropdown-menu>
                </el-dropdown>
                <div class="input-with-select" v-if="activeType=='first'">
                    <el-input v-model.trim="keyword" clearable disabled>
                        <el-button slot="append" icon="el-icon-search" disabled></el-button>
                    </el-input>
                </div>
            </el-row>
            <el-tabs v-model="activeType" @tab-click="handleClick">
                <!-- 基线 -->
                <el-tab-pane :label="i18ns.upgradePackageWarehouse.versionWarehouse_baseline" name="first"
                    :disabled="FDs.length==0">
                    <div>
                        <el-row class="search-row" style="text-align:right">
                            
                            <div class="onlineURL">
                                <span>{{i18ns.upgradePackageWarehouse.versionWarehouse_onlineAddress}}：</span>
                                <el-popover placement="bottom" width="200" trigger="hover" v-if="OnlineStatus!='OK'">
                                    <p>{{i18ns.upgradePackageWarehouse.versionWarehouse_networkStatus}}:<span style="color:#ff4c4c">{{networkStatus}}</span></p>
                                    <p>{{i18ns.upgradePackageWarehouse.versionWarehouse_resolute}}:{{resolute}}</p>
                                    <span slot="reference"><i class="el-icon-info"></i></span>
                                </el-popover>
                                <el-popover placement="top-start" trigger="hover" v-else>
                                    <p>{{i18ns.upgradePackageWarehouse.versionWarehouse_networkStatus}}:{{i18ns.upgradePackageWarehouse.versionWarehouse_networkOK}}</p>
                                    <p>{{i18ns.upgradePackageWarehouse.versionWarehouse_resolute}}:{{i18ns.upgradePackageWarehouse.versionWarehouse_networkOKMethod}}</p>
                                    <span slot="reference"><i class="el-icon-success"></i></span>
                                </el-popover>
                                <span>
                                    {{onlineURL}} 
                                    <i class="el-icon-edit" @click="setOnlineUrl"></i>
                                    <i class="el-icon-refresh" @click="refreshOnlineUrl"></i>
                                </span>
                            </div>
                            <el-button icon="plus" v-on:click="refreshTemplate()">{{i18ns.common.refresh}}</el-button>
                            <el-button icon="plus" v-on:click="addCustomerBaseline()">
                                {{i18ns.upgradePackageWarehouse.versionWarehouse_customBaseline}}</el-button>
                        </el-row>
                        <el-table v-bind:data="listData" border style="width:100%;" :empty-text="emptyText"
                            :element-loading-text="i18ns.common.loading" header-row-class-name="my_table_header">
                            <el-table-column type="expand">
                                <template slot-scope="props">
                                    <p class="descript">
                                        <span class="descLabel">
                                            {{i18ns.upgradePackageWarehouse.versionWarehouse_description}}：
                                        </span>
                                        <span class="desctext">
                                            {{props.row.Description}}
                                        </span>
                                    </p>
                                    <el-table :data="props.row.FirmwarePackages" style="width: 100%;"
                                        header-row-class-name="my_table_header">
                                        <el-table-column prop="PackageName"
                                            :label="i18ns.upgradePackageWarehouse.versionWarehouse_upgradeName">
                                        </el-table-column>
                                        <el-table-column prop="PackageType"
                                            :label="i18ns.upgradePackageWarehouse.versionWarehouse_type">
                                            <template slot-scope="scope">
                                                {{getTypeTxt(scope.row.PackageType)}}
                                            </template>
                                        </el-table-column>
                                        <el-table-column prop="SupportModel"
                                            :label="i18ns.upgradePackageWarehouse.versionWarehouse_productType">
                                        </el-table-column>
                                        <el-table-column prop="Version"
                                            :label="i18ns.upgradePackageWarehouse.versionWarehouse_version">
                                            <template slot-scope="scope">
                                                <p v-for="vis in scope.row.Version">
                                                    <span>{{vis.Module}}：</span>{{vis.CurrentVer}}</p>
                                            </template>
                                        </el-table-column>
                                        <el-table-column prop="Size"
                                            :label="i18ns.upgradePackageWarehouse.versionWarehouse_size">
                                            <template slot-scope="scope">
                                                {{unitFun(scope.row.Size)}}
                                            </template>
                                        </el-table-column>
                                    </el-table>
                                </template>
                            </el-table-column>
                            <el-table-column prop="Name"
                                :label="i18ns.upgradePackageWarehouse.versionWarehouse_baselineName"></el-table-column>
                            <el-table-column prop="Status"
                                :label="i18ns.upgradePackageWarehouse.versionWarehouse_usedState" sortable>
                                <template slot-scope="scope">
                                    <span
                                        v-if="scope.row.Status=='Unused'">{{i18ns.upgradePackageWarehouse.versionWarehouse_notUsed}}</span>
                                    <span
                                        v-else-if="scope.row.Status=='Using'">{{i18ns.upgradePackageWarehouse.versionWarehouse_using}}</span>
                                </template>
                            </el-table-column>
                            <el-table-column prop="Type" :label="i18ns.upgradePackageWarehouse.versionWarehouse_type">
                                <template slot-scope="scope">
                                    {{getTypeTxt(scope.row.Type)}}
                                    <!--  <span v-if="scope.row.Type=='Custom'">{{i18ns.upgradePackageWarehouse.versionWarehouse_customBaseline}}</span>
                                    <span v-else-if="scope.row.Type=='Huawei'">{{i18ns.upgradePackageWarehouse.versionWarehouse_huaweiBaseline}}</span> -->
                                </template>
                            </el-table-column>
                            <el-table-column prop="Version"
                                :label="i18ns.upgradePackageWarehouse.versionWarehouse_version"></el-table-column>
                            <el-table-column prop="ModifyTime"
                                :label="i18ns.upgradePackageWarehouse.versionWarehouse_time" sortable></el-table-column>
                            <el-table-column :label="i18ns.common.operation" width="230px">
                                <template slot-scope="scope">
                                    <el-button type="text" size="small" @click="upgradeDevice(scope.row)">
                                        {{i18ns.upgradePackageWarehouse.versionWarehouse_upgradeDevice}}</el-button>
                                    <el-button type="text" size="small" v-if="scope.row.Type!='Huawei'" :disabled="scope.row.Status=='Using'"
                                        @click="deleteOne(scope.row)">{{i18ns.common.delete}}</el-button>
                                    <el-button type="text" size="small" v-if="scope.row.Type!='Huawei'" :disabled="scope.row.Status=='Using'"
                                        @click="editOne(scope.row)">{{i18ns.config.modify}}</el-button>
                                </template>
                            </el-table-column>
                        </el-table>
                        <el-row class="pagination-row">
                            <el-col v-bind:span="24" style="text-align:left;">
                                <el-pagination @size-change="handleSizeChange" @current-change="handleCurrentChange"
                                    v-bind:current-page="currentPage" v-bind:page-sizes="pageSizes"
                                    v-bind:page-size="pageSize" layout="total, sizes, prev, pager, next, jumper,slot"
                                    v-bind:total="total">
                                    <el-button style="border: 1px solid #c4c4c4;margin-left: 10px;" @click="toensurePage">
                                        {{i18ns.common.confirm}}</el-button>
                                </el-pagination>
                            </el-col>
                        </el-row>
                    </div>

                </el-tab-pane>
                <!-- 升级包 -->
                <el-tab-pane :label="i18ns.upgradePackageWarehouse.versionWarehouse_upgradePackage" name="second"
                    :disabled="FDs.length==0">
                    <div>
                        <el-row class="search-row" style="text-align:right">
                            <!-- <div class="input-with-select">
                                <el-input v-model.trim="keyword" clearable disabled>
                                    <el-button slot="append" icon="el-icon-search" disabled></el-button>
                                </el-input>
                            </div>
                            <el-button icon="plus" v-on:click="refreshPackage()">{{i18ns.common.refresh}}</el-button> -->
                            <el-button icon="plus" v-on:click="deletePackage()">{{i18ns.common.delete}}</el-button>
                            <el-button icon="plus" v-on:click="uploadPackage()">
                                {{i18ns.upgradePackageWarehouse.versionWarehouse_uploadPackages}}</el-button>
                        </el-row>
                        <el-table v-bind:data="packagelistData" border style="width:100%;" :empty-text="emptyText"
                            :element-loading-text="i18ns.common.loading" :header-row-class-name="checkedAll"
                            @selection-change="uploadSelectionChange">
                            <el-table-column type="expand">
                                <template slot-scope="props">
                                    <p class="descript">
                                        <span class="descLabel">
                                            {{i18ns.upgradePackageWarehouse.versionWarehouse_description}}：
                                        </span>
                                        <span class="desctext">
                                            {{props.row.Description}}
                                        </span>
                                    </p>
                                </template>
                            </el-table-column>
                            <el-table-column type="selection" width="55" :selectable='checkboxT'></el-table-column>
                            <el-table-column prop="PackageName"
                                :label="i18ns.upgradePackageWarehouse.versionWarehouse_upgradeName"
                                :show-overflow-tooltip="true"></el-table-column>
                            <el-table-column prop="WorkState"
                                :label="i18ns.upgradePackageWarehouse.versionWarehouse_usedState" sortable>
                                <template slot-scope="scope">
                                    <span
                                        v-if="scope.row.WorkState=='Upgrading'">{{i18ns.upgradePackageWarehouse.versionWarehouse_using}}</span>
                                    <span
                                        v-else-if="scope.row.WorkState=='Unused'">{{i18ns.upgradePackageWarehouse.versionWarehouse_notUsed}}</span>
                                </template>
                            </el-table-column>
                            <el-table-column prop="BindingBaseline"
                                :label="i18ns.upgradePackageWarehouse.versionWarehouse_bindingStatus"
                                :show-overflow-tooltip="true">
                                <template slot-scope="scope">
                                    <span
                                        v-if="scope.row.BindingBaseline&&!scope.row.BindingPlan">{{i18ns.upgradePackageWarehouse.versionWarehouse_bundleUsed}}</span>
                                    <span
                                        v-else-if="!scope.row.BindingBaseline&&scope.row.BindingPlan">{{i18ns.upgradePackageWarehouse.versionWarehouse_bindingUpgradePlan}}</span>
                                    <span
                                        v-else-if="scope.row.BindingBaseline&&scope.row.BindingPlan">{{i18ns.upgradePackageWarehouse.versionWarehouse_bindingUpgradePlanAndCombinePackage}}</span>
                                    <span
                                        v-else-if="!scope.row.BindingBaseline&&!scope.row.BindingPlan">{{i18ns.upgradePackageWarehouse.versionWarehouse_bundleUnUsed}}</span>
                                </template>
                            </el-table-column>

                            <el-table-column prop="Type" :label="i18ns.upgradePackageWarehouse.versionWarehouse_type"
                                :show-overflow-tooltip="true">
                                <template slot-scope="scope">
                                    <span
                                        v-if="scope.row.Type=='Package_Firmware'">{{i18ns.upgradePackageWarehouse.versionWarehouse_packageFirmware}}</span>
                                    <span
                                        v-else-if="scope.row.Type=='Package_Software'">{{i18ns.upgradePackageWarehouse.versionWarehouse_packageSoftware}}</span>
                                    <span
                                        v-else-if="scope.row.Type=='Bundle_Driver'">{{i18ns.upgradePackageWarehouse.versionWarehouse_packageDirve}}</span>
                                    <span
                                        v-else-if="scope.row.Type=='Bundle_Firmware'">{{i18ns.upgradePackageWarehouse.versionWarehouse_bundleFirmware}}</span>
                                    <span
                                        v-else-if="scope.row.Type=='Bundle_Software'">{{i18ns.upgradePackageWarehouse.versionWarehouse_bundleSoftware}}</span>
                                    <span
                                        v-else-if="scope.row.Type=='Board_Firmware'">{{i18ns.upgradePackageWarehouse.versionWarehouse_boardPackage}}</span>
                                    <span
                                        v-else-if="scope.row.Type=='Package_Driver'">{{i18ns.upgradePackageWarehouse.versionWarehouse_packageDirve}}</span>
                                </template>
                            </el-table-column>
                            <el-table-column prop="ProductType"
                                :label="i18ns.upgradePackageWarehouse.versionWarehouse_productType"
                                :show-overflow-tooltip="true"></el-table-column>
                            <el-table-column prop="Version"
                                :label="i18ns.upgradePackageWarehouse.versionWarehouse_version">
                                <template slot-scope="scope">
                                    <p v-for="vis in scope.row.Version"><span>{{vis.Module}}：</span>{{vis.CurrentVer}}
                                    </p>
                                </template>
                            </el-table-column>
                            <el-table-column prop="Size" :label="i18ns.upgradePackageWarehouse.versionWarehouse_size">
                                <template slot-scope="scope">
                                    {{unitFun(scope.row.Size)}}
                                </template>
                            </el-table-column>
                            <el-table-column prop="CreationTime"
                                :label="i18ns.upgradePackageWarehouse.versionWarehouse_createTime" sortable>
                            </el-table-column>
                            <el-table-column :label="i18ns.common.operation" width="180px">
                                <template slot-scope="scope">
                                    <el-button type="text" size="small" @click="upgradePackageDevice(scope.row)">
                                        {{i18ns.upgradePackageWarehouse.versionWarehouse_upgradeDevice}}</el-button>
                                    <el-button type="text" size="small" @click="deletePackage(scope.row)"
                                        :disabled="checkboxT(scope.row)==0">{{i18ns.common.delete}}</el-button>
                                </template>
                            </el-table-column>
                        </el-table>
                        <el-row class="pagination-row">
                            <el-col v-bind:span="24" style="text-align:left;">
                                <el-pagination @size-change="handleSizeChange" @current-change="handleCurrentChange"
                                    v-bind:current-page="package.currentPage" v-bind:page-sizes="package.pageSizes"
                                    v-bind:page-size="package.pageSize"
                                    layout="total, sizes, prev, pager, next, jumper,slot" v-bind:total="packageTotal">
                                    <el-button style="border: 1px solid #c4c4c4;margin-left: 10px;">
                                        {{i18ns.common.confirm}}</el-button>
                                </el-pagination>
                            </el-col>
                        </el-row>
                    </div>
                </el-tab-pane>
            </el-tabs>
        </div>
        <!-- 删除基线 -->
        <el-dialog :close-on-click-modal="false" :title="i18ns.common.prompt" :visible.sync="tipsDialogisible"
            width="60%">
            <el-row>
                <el-alert :title="i18ns.common.confirmDelete" type="warning"
                    :description="i18ns.common.confirmDelete4+i18ns.common.common_rolesModelTip" show-icon
                    :closable="false">
                </el-alert>
            </el-row>
            <el-table :data="deleteList" border style="width: 100%; margin-top: 10px;"
                header-row-class-name="my_table_header">
                <el-table-column prop="Name" :label="i18ns.upgradePackageWarehouse.versionWarehouse_baselineName">
                </el-table-column>
                <el-table-column prop="Status" :label="i18ns.upgradePackageWarehouse.versionWarehouse_usedState"
                    sortable>
                    <template slot-scope="scope">
                        <span
                            v-if="scope.row.Status=='Unused'">{{i18ns.upgradePackageWarehouse.versionWarehouse_notUsed}}</span>
                        <span
                            v-else-if="scope.row.Status=='Using'">{{i18ns.upgradePackageWarehouse.versionWarehouse_using}}</span>
                    </template>
                </el-table-column>
                <el-table-column prop="Type" :label="i18ns.upgradePackageWarehouse.versionWarehouse_type">
                    <template slot-scope="scope">
                        <span
                            v-if="scope.row.Type=='Custom'">{{i18ns.upgradePackageWarehouse.versionWarehouse_customBaseline}}</span>
                        <span v-else>{{i18ns.upgradePackageWarehouse.versionWarehouse_huaweiBaseline}}</span>
                    </template>
                </el-table-column>
                <el-table-column prop="ModifyTime" :label="i18ns.upgradePackageWarehouse.versionWarehouse_time"
                    sortable></el-table-column>
            </el-table>
            <div slot="footer" class="dialog-footer">
                <el-button @click="tipsDialogisible=false">{{i18ns.common.cancel}}</el-button>
                <el-button @click="deleteSubmit" v-loading.fullscreen.lock="fullscreenLoading"
                    v-show="deleteList.length>0" :element-loading-text="i18ns.common.loading" type="primary">
                    {{i18ns.common.confirm}}</el-button>
            </div>
        </el-dialog>
        <!-- 删除升级包 -->
        <el-dialog :close-on-click-modal="false" :title="i18ns.common.prompt" :visible.sync="packageDialogisible"
            width="60%">
            <el-row>
                <el-alert :title="i18ns.common.confirmDelete" type="warning"
                    :description="i18ns.common.confirmDelete4+i18ns.common.common_rolesModelTip" show-icon
                    :closable="false">
                </el-alert>
            </el-row>
            <el-table :data="deletePackageList" border style="width: 100%; margin-top: 10px;"
                header-row-class-name="my_table_header">
                <el-table-column prop="PackageName" :label="i18ns.upgradePackageWarehouse.versionWarehouse_upgradeName">
                </el-table-column>
                <el-table-column prop="BindingPlan" :label="i18ns.upgradePackageWarehouse.versionWarehouse_usedState"
                    sortable>
                    <template slot-scope="scope">
                        <span
                            v-if="scope.row.BindingPlan==true">{{i18ns.upgradePackageWarehouse.versionWarehouse_using}}</span>
                        <span v-else>{{i18ns.upgradePackageWarehouse.versionWarehouse_notUsed}}</span>
                    </template>
                </el-table-column>
                <el-table-column prop="BindingBaseline"
                    :label="i18ns.upgradePackageWarehouse.versionWarehouse_bindingStatus">
                    <template slot-scope="scope">
                        <span
                            v-if="scope.row.BindingBaseline&&!scope.row.BindingPlan">{{i18ns.upgradePackageWarehouse.versionWarehouse_bundleUsed}}</span>
                        <span
                            v-else-if="!scope.row.BindingBaseline&&scope.row.BindingPlan">{{i18ns.upgradePackageWarehouse.versionWarehouse_bindingUpgradePlan}}</span>
                        <span
                            v-else-if="scope.row.BindingBaseline&&scope.row.BindingPlan">{{i18ns.upgradePackageWarehouse.versionWarehouse_bindingUpgradePlanAndCombinePackage}}</span>
                        <span
                            v-else-if="!scope.row.BindingBaseline&&!scope.row.BindingPlan">{{i18ns.upgradePackageWarehouse.versionWarehouse_bundleUnUsed}}</span>
                    </template>
                </el-table-column>
                <el-table-column prop="Size" :label="i18ns.upgradePackageWarehouse.versionWarehouse_size">
                    <template slot-scope="scope">
                        {{unitFun(scope.row.Size)}}
                    </template>
                </el-table-column>
            </el-table>
            <div slot="footer" class="dialog-footer">
                <el-button @click="packageDialogisible=false">{{i18ns.common.cancel}}</el-button>
                <el-button @click="deletePackageSubmit" v-loading.fullscreen.lock="fullscreenLoading"
                    :element-loading-text="i18ns.common.loading" type="primary">{{i18ns.common.confirm}}</el-button>
            </div>
        </el-dialog>
        <!-- 上传升级包 -->
        <el-dialog :close-on-click-modal="false" :title="i18ns.upgradePackageWarehouse.versionWarehouse_uploadPackages"
            :visible.sync="uploadisible" width="80%">
            <p style="color:#999;">
                <i class="el-icon-info" style="color:#409EFF"></i>
                {{i18ns.upgradePackageWarehouse.versionWarehouse_downLoadTip}}
            </p>
            <el-form v-bind:model="uploadForm" v-bind:rules="rules" ref="uploadForm" v-bind:label-width="labelWidth"
                label-position="left" label-suffix=":">
                <el-form-item :label="i18ns.upgradePackageWarehouse.versionWarehouse_selectUpgradePackage"
                    prop="FilePath">
                    <el-row style="position: absolute;">
                        <el-button size="small" type="primary" :disabled="true" v-show="fileDisabled">
                            {{i18ns.imageManage.imageManage_pleaseUpload}}</el-button>
                        <el-button size="small" @click="cancelUpload" v-show="fileDisabled">
                            {{i18ns.imageManage.imageManage_cancelUpload}}</el-button>
                    </el-row>
                    <el-upload ref="upload" name="tiFile" :action="updalodUrl" :file-list="fileList" accept=".zip"
                        :on-success="uploadSuccess" :on-error="uploadError" :multiple="false"
                        :before-upload="beforeUpdalod" :on-remove="removeFile" :limit="1" :on-exceed="fileExceed"
                        :on-progress="uploadProgress">
                        <el-button size="small" type="primary" @click="fileClick('first')" v-show="!fileDisabled">
                            {{i18ns.imageManage.imageManage_pleaseUpload}}</el-button>

                    </el-upload>
                </el-form-item>
                <el-form-item :label="i18ns.upgradePackageWarehouse.versionWarehouse_selectAsc" prop="AscPath">
                    <el-row style="position: absolute;">
                        <el-button size="small" type="primary" :disabled="true" v-show="fileAscDisabled">
                            {{i18ns.imageManage.imageManage_pleaseUpload}}</el-button>
                        <el-button size="small" @click="cancelAscUpload" v-show="fileAscDisabled">
                            {{i18ns.imageManage.imageManage_cancelUpload}}</el-button>
                    </el-row>
                    <el-upload ref="uploadAsc" name="tiFile" :action="updalodUrl" :file-list="fileAscList" accept=".asc"
                        :on-success="uploadAscSuccess" :on-error="uploadAscError" :multiple="false"
                        :before-upload="beforeUpdalod" :on-remove="removeAscFile" :limit="1" :on-exceed="fileExceed"
                        :on-progress="uploadProgress">
                        <el-button size="small" type="primary" @click="fileClick('second')" v-show="!fileAscDisabled">
                            {{i18ns.imageManage.imageManage_pleaseUpload}}</el-button>

                    </el-upload>
                </el-form-item>
                <el-form-item :label="i18ns.upgradePackageWarehouse.versionWarehouse_description" prop="Description">
                    <el-input type="textarea" v-model="uploadForm.Description" rows="5" style="max-width:400px;"
                        maxlength="256" :placeholder="i18ns.upgradePackageWarehouse.versionWarehouse_descriptionRange">
                    </el-input>
                    <span class="desLength"> <span>{{uploadForm.Description.length}}</span>/256</span>
                </el-form-item>
            </el-form>
            <div slot="footer" class="dialog-footer">
                <el-button @click="uploadisible=false">{{i18ns.common.cancel}}</el-button>
                <el-button @click="packageSubmit" v-loading.fullscreen.lock="fullscreenLoading"
                    :element-loading-text="i18ns.common.loading"
                    :disabled="uploadForm.FilePath==''||uploadForm.AscPath==''" type="primary">{{i18ns.common.import}}
                </el-button>
            </div>
        </el-dialog>
        <!-- 在线地址 -->
        <el-dialog :close-on-click-modal="false" :title="i18ns.common.modify"
            :visible.sync="onlineDialog" width="60%">
            <el-form ref="onlineform" :model="onlineform" :rules="onlineRule" label-suffix=":">
                <el-form-item :label="i18ns.upgradePackageWarehouse.versionWarehouse_onlineAddress" label-width="170px"
                    prop="OnlineURL">
                    <el-popover placement="top-start" title="" trigger="hover"
                        :content="i18ns.upgradePackageWarehouse.versionWarehouse_urlRule">
                        <el-input slot="reference" v-model="onlineform.OnlineURL"></el-input>
                    </el-popover>
                </el-form-item>
            </el-form>
            <div slot="footer" class="dialog-footer">
                <el-button @click="onlineDialog = false">{{i18ns.common.cancel}}</el-button>
                <el-button type="primary" @click="ensureURL('onlineform')">{{i18ns.common.confirm}}</el-button>
            </div>
        </el-dialog>
    </div>
    <script>
        var app = new Vue({
            el: '#app',
            data: {
                i18ns: [],
                FDs: [],
                FDIp: '',
                menuName: '',
                menuKey: '',
                listData: [],
                profileId: '', //配置ID
                /*显示表格数据加载中*/
                loading: false,
                /*删除操作遮罩*/
                fullscreenLoading: false,
                currentPage: 1,
                pageSizes: [10, 20, 50, 100],
                pageSize: 10,
                total: 0,
                multipleSelection: [],

                deviceListSelection: [],
                tipsDialogisible: false,

                deleteList: [], //要删除的数据
                keyword: '',
                onlineURL: '--',
                OnlineStatus:'',
                activeType: 'first',
                activeName: 'first',
                /*上传升级包*/
                packagelistData: [],
                package: {
                    currentPage: 1,
                    pageSize: 10,
                    pageSizes: [10, 20, 50, 100],
                },
                packageTotal: 0,
                uploadisible: false,
                uploadForm: {
                    FilePath: '',
                    AscPath: '',
                    Description: '',
                },

                fileList: [],
                fileDisabled: false,
                isShowUploadTip: false,
                rules: {
                    FilePath: {
                        required: true,
                        trigger: 'change'
                    },
                    AscPath: {
                        required: true,
                        trigger: 'change'
                    }
                },
                labelWidth: '215px',
                /*上传数字签名*/
                fileAscList: [],
                fileAscDisabled: false,
                fileName: '',
                fileAscName: '',

                // 删除升级包
                deletePackageList: [],
                packageDialogisible: false,
                checkedDelPackage: [],
                //在线地址
                onlineDialog: false,
                onlineform: {
                    OnlineURL: ''
                },
                onlineRule: {
                    OnlineURL: {
                        required: true,
                        validator: function (rule, value, callback) {
                            if (value) {
                                var regUrl = /^(http:\/\/|https:\/\/)+[\w]+[\w-:.\/?%&=]+[\/\w]$/;
                                if (!regUrl.test(value)) {
                                    return callback(new Error(app.i18ns.upgradePackageWarehouse
                                        .versionWarehouse_urlFormat));
                                } else {
                                    return callback();
                                }
                            } else {
                                return callback(new Error(app.i18ns.upgradePackageWarehouse
                                    .configInfo_inputNotNull));
                            }
                        },
                        trigger: 'blur'
                    }
                },
                emptyText: '',
                networkStatus:'',
                resolute:''

            },
            created: function () {
                sessionStorage.removeItem('packageCode')
                sessionStorage.removeItem('packageCode-codeDate')
                this.i18ns = getIn18();
                this.emptyText = this.i18ns.common.loading;
                var _pageSize = localStorage.getItem("baselineListPageSize");
                this.activeType = getQueryString('type') ? getQueryString('type') : 'first';
                if (_pageSize) {
                    this.pageSize = parseInt(_pageSize);
                };
            },
            computed: {
                updalodUrl: function () {
                    return com_huawei_fdvcenterpluginui.webContextPath + '/rest/services/fd/upload?ips=' +
                        this.FDIp +'&httpMethod=POST&endpoint=/rich/UpgradeService/Actions/Package.Import';
                },
                /**
                 * 升级包全选的禁用
                 */
                checkedAll: function () {
                    var displayDisabled = [],
                        displayData = this.packagelistData;
                    _.each(displayData, function (displayElement) {
                        if (displayElement.WorkState === 'Upgrading' || displayElement.BindingPlan || displayElement.BindingBaseline) {
                            displayDisabled.push(displayElement);
                        }
                    });
                    if (displayDisabled.length === displayData.length) {
                        return 'package_table_header'
                    } else {
                        return ''
                    }
                },
            },
            mounted: function () {
                var that = this;
                //获取FD列表数据
                setTimeout(function () {
                    getFDList(that.bindFD);
                }, 0);
                //输入框键盘事件监听
                $('.is-in-pagination .el-input__inner').bind('keydown',function(event){
                    if(event.keyCode == "13") {
                        var value = parseInt(this.value);
                        that.handleCurrentChange(value);
                    }
                });
            },
            methods: {
                toensurePage:function(){
                    var value = parseInt($('.is-in-pagination .el-input__inner').val());
                    this.handleCurrentChange(value);
                },
                unitFun: function (Size) {
                    return unitFun(Size)
                },
                getTypeTxt: function (data) {
                    switch (data) {
                        case "Huawei":
                            return this.i18ns.upgradePackageWarehouse.versionWarehouse_huaweiBaseline;
                        case "Custom":
                            return this.i18ns.upgradePackageWarehouse.versionWarehouse_customBaseline;
                        case "Bundle_Firmware":
                            return this.i18ns.upgradePackageWarehouse.versionWarehouse_bundleFirmware;
                        case "Bundle_Driver":
                            return this.i18ns.upgradePackageWarehouse.versionWarehouse_bundleDirve;
                        case "Bundle_Software":
                            return this.i18ns.upgradePackageWarehouse.versionWarehouse_bundleSoftware;
                        case "Package_Driver":
                            return this.i18ns.upgradePackageWarehouse.versionWarehouse_packageDirve;
                        case "Package_Firmware":
                            return this.i18ns.upgradePackageWarehouse.versionWarehouse_packageFirmware;
                        case "Board_Firmware":
                            return this.i18ns.upgradePackageWarehouse.versionWarehouse_boardPackage;
                        default:
                            return '--';
                    }
                },

                /**
                 * 获取FD数据 回调函数
                 * 
                 * @param {any} ret 
                 */
                bindFD: function (ret) {
                    if (ret.code === '0') {
                        var lg = ret.data.length;
                        if (lg > 0) {
                            for (var i = 0; i <
                                lg; i++) {
                                if (ret.data[i].aliasName) {
                                    this.FDs.push({
                                        label: ret.data[i].aliasName,
                                        name: ret.data[i].hostIp
                                    });
                                } else {
                                    this.FDs.push({
                                        label: ret.data[i].hostIp,
                                        name: ret.data[i].hostIp
                                    });
                                }
                            }
                            var currentFD = getCurrentFD();
                            if (currentFD) {
                                var _currentFD = _.find(this.FDs, {
                                    name: currentFD
                                })
                                if (_currentFD) {
                                    this.FDIp = currentFD;
                                    this.menuName = _currentFD.label; /*设置选项卡下拉框默认选中项*/
                                    this.menuKey = _currentFD.name; /*设置选项卡下拉框默认选中项*/
                                } else {
                                    setCurrentFD(ret.data[0].hostIp);
                                    this.FDIp = ret.data[0].hostIp;
                                    this.menuName = this.FDs[0].label; /*设置选项卡下拉框默认选中项*/
                                    this.menuKey = this.FDs[0].name; /*设置选项卡下拉框默认选中项*/
                                }
                            } else {
                                setCurrentFD(ret.data[0].hostIp);
                                this.FDIp = ret.data[0].hostIp;
                                this.menuName = this.FDs[0].label; /*设置选项卡下拉框默认选中项*/
                                this.menuKey = this.FDs[0].name; /*设置选项卡下拉框默认选中项*/
                            }
                            this.emptyText = this.i18ns.common.loading;
                            if (this.activeType != "first") {
                                this.getPackageListData()
                            } else {
                                this.getListData(); /*获取列表数据*/
                                this.getUrl();
                            }
                        } else {
                            alertMsg(getErrorMsg({
                                code: '-90002'
                            }))
                        }
                    } else {
                        if (ret.ip != app.FDIp) {
                            return false
                        }
                        var msg = getErrorMsg(ret);
                        alertMsg(msg);
                    }
                },

                /**
                 * FD下拉框 点击切换事件
                 * 
                 * @param {any} command 
                 * @param {any} com 
                 */
                commandClick: function (command, com) {
                    this.menuName = com.$el.innerText;
                    this.menuKey = command;
                    this.FDIp = command;
                    setCurrentFD(command);
                    this.currentPage = 1;
                    this.pageSize = 10;
                    this.total = 0;
                    this.package = {
                        currentPage: 1,
                        pageSizes: [10, 20, 50, 100],
                        pageSize: 10,
                    };
                    this.getListData();
                    this.getPackageListData();
                    this.getUrl();
                },

                /**
                 * 切换 基线 升级包
                 */
                handleClick: function () {
                    if (this.activeType == "first") {
                        this.getListData()
                    } else {
                        this.getPackageListData();
                    }
                },

                /**
                 * 获取在线地址
                 */
                getUrl:function(){
                    upgradePackageManage.getOnlineUrl({
                        ip: this.FDIp,
                    }, function(ret){
                        if (ret.code == '0') {
                            var  obj = ret.data[0].data;
                            app.onlineURL=  obj.OnlineURL;
                            app.OnlineStatus=obj.OnlineStatus;
                            app.getListData()
                            app.baseStatus()
                        } else {
                            if (ret.ip != app.FDIp) {
                                return false
                            }
                            var msg = getErrorMsg(ret);
                            alertMsg(msg);
                        }
                    });
                },
                /**
                 * 刷新在线地址
                 */
                refreshOnlineUrl:function(){
                    this.getUrl()
                },

                /**
                 * 获取基线的列表
                 */
                getListData: function () {
                    upgradePackageManage.getBaselineList({
                        ip: this.FDIp,
                        "pageNo": this.currentPage,
                        "pageSize": this.pageSize
                    }, this.bindList);
                },
                /**
                 * 获取基线列表数据 回调函数
                 * 
                 * @param {any} ret 
                 */
                bindList: function (ret) {
                    this.listData = [];
                    this.emptyText = this.i18ns.common.noData;
                    if (ret.code === '0') {
                        this.listData = ret.data[0].data.Members;
                        this.total = ret.data[0].data['Members@odata.count'];
                    } else {
                        alertErrMsg(ret, 'packageCode');
                    }
                },
                /**
                 * 刷新基线列表
                 */
                refreshTemplate: function () {
                    this.emptyText = this.i18ns.common.loading;
                    this.getListData()
                },
                /**
                 * 设置当前显示数据的总数
                 * 
                 * @param {any} val 
                 */
                handleSizeChange: function (val) {
                    if (this.activeType == "first") {
                        this.pageSize = val;
                        this.currentPage = 1;
                        localStorage.setItem("baselineListPageSize", val);
                        this.getListData();
                    } else {
                        this.package.currentPage = 1;
                        this.package.pageSize = val;
                        this.getPackageListData();
                    }
                },
                /**
                 * 切换当前显示页
                 * 
                 * @param {any} val 
                 */
                handleCurrentChange: function (val) {
                    if (this.activeType == "first") {
                        this.currentPage = val;
                        this.getListData();
                    } else {
                        this.package.currentPage = val;
                        this.getPackageListData();
                    }
                },
                /**
                 * 自定义基线
                 */
                addCustomerBaseline: function () {
                    window.location.href = './createBaseline.html';
                },
                /**
                 * 升级到设备
                 */
                upgradeDevice: function (row) {
                    window.location.href = '../upgradePlan/create.html?toType=' + 'baseline';
                    sessionStorage.setItem('upgradePlanVis', JSON.stringify(row))
                },
                upgradePackageDevice: function (row) {
                    window.location.href = '../upgradePlan/create.html?toType=' + 'package'
                    sessionStorage.setItem('upgradePlanVis', JSON.stringify(row))
                },
                /**
                 * 删除一条基线
                 * 
                 * @param {object} row 
                 */
                deleteOne: function (row) {
                    this.deleteList = [];
                    this.tipsDialogisible = true;
                    this.deleteList.push(row);
                },
                /**
                 * 确定删除基线
                 */
                deleteSubmit: function () {
                    upgradePackageManage.deleteBaseline({
                        ip: this.FDIp,
                        id: this.deleteList[0].UUID
                    }, function (ret) {
                        if (ret.code == '0') {
                            app.tipsDialogisible = false;
                            if (app.listData.length - 1 == 0 && app.currentPage > 1) {
                                app.currentPage = app.currentPage - 1;
                            }
                            app.getListData()
                        } else {
                            if (ret.ip != app.FDIp) {
                                return false
                            }
                            var msg = getErrorMsg(ret);
                            alertMsg(msg);
                        }
                    });
                },

                /**
                 * 跳转 基线修改
                 */
                editOne: function (row) {
                    window.location.href = './editBaseline.html?id=' + row.UUID;
                },

                /**
                 * 获取升级包
                 */
                getPackageListData: function () {
                    this.packagelistData = [];
                    this.emptyText = this.i18ns.common.loading;
                    upgradePackageManage.getPackageList({
                        ip: this.FDIp,
                        "pageNo": this.package.currentPage,
                        "pageSize": this.package.pageSize
                    }, function (ret) {
                        app.emptyText = app.i18ns.common.noData;
                        if (ret.code == '0') {
                            app.packagelistData = ret.data[0].data.Members;
                            app.packageTotal = ret.data[0].data['Members@odata.count'];
                        } else {
                            // if (ret.ip != app.FDIp) {
                            //     return false
                            // } else if (!isAlert(ret, 'packageCode')) {
                            //     return false
                            // }
                            // var msg = getErrorMsg(ret);
                            // alertMsg(msg);
                            alertErrMsg(ret, 'packageCode');
                        }
                    });
                },
                /**
                 * 禁用升级包的复选框
                 */
                checkboxT: function (row, index) {
                    if (row.WorkState === 'Upgrading' || row.BindingPlan || row.BindingBaseline) {
                        return 0;
                    } else {
                        return 1;
                    }
                },
                /**
                 * 刷新升级包
                 */
                refreshPackage: function () {
                    this.getPackageListData()
                },
                /**
                 * 删除升级包
                 */
                deletePackage: function (row) {
                    this.deletePackageList = [];
                    if (row) {
                        this.deletePackageList.push(row);
                    } else {
                        this.deletePackageList = this.checkedDelPackage;
                    }
                    if (this.deletePackageList.length <= 0) {
                        this.$message({
                            message: this.i18ns.common.deleteNoSelect
                                .format(this.i18ns.upgradePackage.upgradePackagesWord),
                            type: 'error'
                        });
                    } else {
                        this.packageDialogisible = true;
                    }
                },
                /**
                 * 确认删除升级包
                 */
                deletePackageSubmit: function () {
                    this.fullscreenLoading = true;
                    for (var i = 0; i < this.deletePackageList.length; i++) {
                        upgradePackageManage.deletePackageList({
                            ip: this.FDIp,
                            id: this.deletePackageList[i].UUID
                        }, function (ret) {
                            setTimeout(function () {
                                app.fullscreenLoading = false; /*隐藏loading提示*/
                            }, intervalTime); //延迟半秒在关闭loading
                            if (ret.code == '0') {
                                app.packageDialogisible = false;
                                if (app.packagelistData.length - 1 == 0 && app.package.currentPage >
                                    1) {
                                    app.package.currentPage = app.package.currentPage - 1;
                                }
                                app.getPackageListData()
                            } else {
                                if (ret.ip != app.FDIp) {
                                    return false
                                }
                                var msg = getErrorMsg(ret);
                                alertMsg(msg);
                            }
                        });
                    }

                },
                /**
                 * 上传升级包
                 */
                uploadPackage: function () {
                    this.uploadisible = true;
                    this.fileAscList = [];
                    this.fileList = [];
                    this.fileName = "";
                    this.fileAscName = "";
                    this.uploadForm = {
                        FilePath: '',
                        AscPath: '',
                        Description: '',
                    };
                    this.fileDisabled = false;
                    this.fileAscDisabled = false;
                },
                /**
                 * 选择升级包
                 */
                uploadSelectionChange: function (val) {
                    this.checkedDelPackage = val
                },
                /**
                 * 上传升级包 ，数字签名
                 */
                uploadProgress: function (event, file, fileList) {
                    if (event.percent == 100) {
                        this.isShowUploadTip = true;
                    } else {
                        this.isShowUploadTip = false;
                    }
                },
                fileClick: function (itemtype) {
                    this.activeName = itemtype;
                    if (itemtype == 'first' && this.fileDisabled) {
                        event.stopPropagation()
                        return false;
                    }
                    if (itemtype == 'second' && this.fileAscDisabled) {
                        event.stopPropagation()
                        return false;
                    }
                },
                fileExceed: function (files, fileList) {
                    console.log(files);
                },
                beforeUpdalod: function (file) {
                    if (this.activeName == "first") {
                        var flieArr = file.name.split('.');
                        if (flieArr[flieArr.length - 1] != 'zip') {
                            app.$message({
                                message: app.i18ns.upgradePackageWarehouse
                                    .versionWarehouse_selectZipPackage,
                                type: 'error'
                            });
                            this.fileDisabled = false;
                            return false;
                        }
                        this.fileName = file.name.replace('.zip', "");
                        if (this.fileAscName != "" && this.fileName != this.fileAscName) {
                            app.$message({
                                message: app.i18ns.upgradePackageWarehouse
                                    .versionWarehouse_nameSame,
                                type: 'error'
                            });
                            this.fileDisabled = false;
                            return false;
                        }
                        this.fileDisabled = true;
                    } else {
                        var flieArr = file.name.split('.');
                        if (flieArr[flieArr.length - 1] != 'asc') {
                            app.$message({
                                message: app.i18ns.upgradePackageWarehouse
                                    .versionWarehouse_selectAscPackage,
                                type: 'error'
                            });
                            this.fileAscDisabled = false;
                            return false;
                        }
                        this.fileAscName = file.name.replace('.zip.asc', "");
                        if (this.fileName != "" && this.fileName != this.fileAscName) {
                            app.$message({
                                message: app.i18ns.upgradePackageWarehouse
                                    .versionWarehouse_nameSame,
                                type: 'error'
                            });
                            this.fileAscDisabled = false;
                            return false;
                        }
                        this.fileAscDisabled = true;
                    }
                    var param = {
                        ip: this.FDIp,
                        data: {
                            PackageName: this.activeName == "first" ? this.fileName : this.fileAscName,
                            Size: file.size.toString()
                        }
                    };
                    var promise = new Promise(function (resolve, reject) {
                        upgradePackageManage.checkRepository(param, function (ret) {
                            if (ret.code == 0) {
                                if (!ret.data[0].data.PackageName) {
                                    if (app.activeName == "first") {
                                        alertMsg(app.i18ns.upgradePackageWarehouse
                                            .versionWarehouse_packageAlreadyExists);
                                    } else {
                                        alertMsg(app.i18ns.upgradePackageWarehouse
                                            .versionWarehouse_AscAlreadyExists);
                                    }
                                    reject("upload error")
                                } else if (!ret.data[0].data.Capicity) {
                                    if (app.activeName == "first") {
                                        alertMsg(app.i18ns.upgradePackageWarehouse
                                            .versionWarehouse_storageSpaceRemainingCleanUp
                                        );
                                    } else {
                                        alertMsg(app.i18ns.upgradePackageWarehouse
                                            .versionWarehouse_storageSpaceRemainingCleanUp
                                        );
                                    }
                                    reject("upload error")
                                } else {
                                    resolve();
                                }
                            } else {
                                if (ret.ip != app.FDIp) {
                                    return false
                                }
                                var msg = getErrorMsg(ret);
                                alertMsg(msg);
                                reject("upload error")
                            }
                        })
                    });
                    return promise;
                },
                splitFileName: function (text) {
                    var pattern = /\.{1}[a-z]{1,}$/;
                    if (pattern.exec(text) !== null) {
                        return (text.slice(0, pattern.exec(text).index));
                    }
                },
                removeFile: function () {
                    this.isShowUploadTip = false;
                    this.fileDisabled = false;
                    this.uploadForm.FilePath = '';
                    this.fileName = "";
                },
                removeAscFile: function () {
                    this.isShowUploadTip = false;
                    this.fileAscDisabled = false;
                    this.uploadForm.AscPath = '';
                    this.fileAscName = "";
                },
                uploadSuccess: function (ret, file, fileList) {
                    if (ret.code == '0') {
                        this.isShowUploadTip = false;
                        this.uploadForm.FilePath = ret.data[0].data.FilePath;
                    } else {
                        this.fileList = [];
                        this.fileDisabled = false;
                        this.isShowUploadTip = false;
                        this.uploadForm.FilePath = '';
                        this.fileName = "";
                        if (ret.ip != app.FDIp) {
                            return false
                        }
                        var msg = getErrorMsg(ret);
                        alertMsg(msg);
                    }
                },
                uploadAscSuccess: function (ret, file, fileList) {
                    if (ret.code == '0') {
                        this.isShowUploadTip = false;
                        this.uploadForm.AscPath = ret.data[0].data.FilePath;
                    } else {
                        this.fileAscList = [];
                        this.fileAscDisabled = false;
                        this.isShowUploadTip = false;
                        this.uploadForm.AscPath = '';
                        this.fileAscName = "";
                        if (ret.ip != app.FDIp) {
                            return false
                        }
                        var msg = getErrorMsg(ret);
                        alertMsg(msg);
                    }
                },
                uploadError: function (err, file, fileList) {
                    this.fileDisabled = false;
                    this.isShowUploadTip = false;
                    this.uploadForm.FilePath = '';
                    this.fileName = "";
                    alertMsg(this.i18ns.common.uploadFail);
                },
                uploadAscError: function (err, file, fileList) {
                    this.fileAscDisabled = false;
                    this.isShowUploadTip = false;
                    this.uploadForm.AscPath = '';
                    this.fileAscName = "";
                    alertMsg(this.i18ns.common.uploadFail);
                },
                cancelUpload: function () {
                    this.$refs.upload.abort();
                    this.$refs.upload.uploadFiles = [];
                    this.fileDisabled = false;
                    this.uploadForm.FilePath = '';
                    this.fileName = "";
                },
                cancelAscUpload: function () {
                    this.$refs.uploadAsc.abort();
                    this.$refs.uploadAsc.uploadFiles = [];
                    this.fileAscDisabled = false;
                    this.uploadForm.AscPath = '';
                    this.fileAscName = "";
                },
                // 导入升级包
                packageSubmit: function () {
                    upgradePackageManage.importPackageFile({
                        ip: this.FDIp,
                        data: this.uploadForm
                    }, function (ret) {
                        if (ret.code == '0') {
                            app.uploadisible = false;
                            var taskId = ret.data[0].data.TaskID;
                            var mysetInterval = setInterval(function () {
                                upgradePackageManage.getMasterTaskInfo({
                                    ip: app.FDIp,
                                    id: taskId
                                }, function (res) {
                                    if (res.code == 0) {
                                        if (res.data[0].data.Status == 'Finish') {
                                            window.clearInterval(mysetInterval);
                                            app.getPackageListData();
                                        }
                                    }
                                    if (res.data[0].data.Status == 'Failed') {
                                        window.clearInterval(mysetInterval);
                                        app.getPackageListData();
                                    }
                                });
                            }, 1000);

                        } else {
                            if (ret.ip != app.FDIp) {
                                return false
                            }
                            var msg = getErrorMsg(ret);
                            alertMsg(msg);
                        }
                    });
                },
                /**
                 * 在线地址
                 */
                setOnlineUrl: function () {
                    this.onlineDialog = true;
                    this.onlineform.OnlineURL = this.onlineURL;
                    Vue.nextTick(function () {
                        app.$refs.onlineform.clearValidate();
                    })

                },
                /**
                 * 确定在线地址
                 */
                ensureURL: function (formName) {
                    this.$refs[formName].validate(function (valid) {
                        if (valid) {
                            upgradePackageManage.addOnlineUrl({
                                ip: app.FDIp,
                                data: {
                                    OnlineURL:app.onlineform.OnlineURL
                                }
                            }, function (ret) {
                                if (ret.code == '0') {
                                    app.onlineDialog = false;
                                    app.OnlineURL = app.onlineform.OnlineURL;
                                    app.getUrl();

                                } else {
                                    if (ret.ip != app.FDIp) {
                                        return false
                                    }
                                    var msg = getErrorMsg(ret);
                                    alertMsg(msg);
                                }
                            });
                        } else {
                            return false;
                        }
                    });
                },
                /**
                 * 在线地址的不同状态
                 */
                baseStatus:function(){
                    switch (this.OnlineStatus) {
                        case 'UnknownFailed':
                            this.networkStatus= this.i18ns.upgradePackageWarehouse.versionWarehouse_networkUnknownFailed
                            this.resolute= this.i18ns.upgradePackageWarehouse.versionWarehouse_networkUnknownFailedMethodTwo+
                                           this.i18ns.upgradePackageWarehouse.versionWarehouse_networkUnknownFailedMethodThree+
                                           this.i18ns.upgradePackageWarehouse.versionWarehouse_networkUnknownFailedMethodFour
                            this.iconClass=''
                            break;
                        case 'DNSFailed':
                            this.networkStatus= this.i18ns.upgradePackageWarehouse.versionWarehouse_networkDNSFailed
                            this.resolute= this.i18ns.upgradePackageWarehouse.versionWarehouse_networkDNSFailedMethod
                            this.iconClass=''
                            break;
                        case 'ProxyFailed':
                            this.networkStatus= this.i18ns.upgradePackageWarehouse.versionWarehouse_networkProxyFailed
                            this.resolute= this.i18ns.upgradePackageWarehouse.versionWarehouse_networkProxyFailedMethod
                            this.iconClass=''
                            break;
                        case 'TargetURLFailed':
                            this.networkStatus= this.i18ns.upgradePackageWarehouse.versionWarehouse_networkTargetURLFailed
                            this.resolute= this.i18ns.upgradePackageWarehouse.versionWarehouse_networkTargetURLFailedMethod
                            this.iconClass=''
                            break;
                        case 'TargetAccessFailed':
                            this.networkStatus= this.i18ns.upgradePackageWarehouse.versionWarehouse_networkTargetAccessFailed
                            this.resolute= this.i18ns.upgradePackageWarehouse.versionWarehouse_networkTargetAccessFailedMethod
                            this.iconClass=''
                            break;
                        case 'Unknown':
                            this.networkStatus= this.i18ns.upgradePackageWarehouse.versionWarehouse_networkUnknown
                            this.resolute= this.i18ns.upgradePackageWarehouse.versionWarehouse_networkUnknownMethod
                            this.iconClass=''
                            break;
                        case 'Testing':
                            this.networkStatus= this.i18ns.upgradePackageWarehouse.versionWarehouse_networkTesting
                            this.resolute= this.i18ns.upgradePackageWarehouse.versionWarehouse_networkTestingMethod
                            this.iconClass=''
                            break;
                        case 'LicenseErr':
                            this.networkStatus= this.i18ns.upgradePackageWarehouse.versionWarehouse_LicenseFailed
                            this.resolute= this.i18ns.upgradePackageWarehouse.versionWarehouse_LicenseFailedMethod
                            this.iconClass=''
                            break;
                        default:
                            this.networkStatus= this.i18ns.upgradePackageWarehouse.versionWarehouse_networkUnknownFailed
                            this.resolute= this.i18ns.upgradePackageWarehouse.versionWarehouse_networkUnknownFailedMethodTwo+
                                           this.i18ns.upgradePackageWarehouse.versionWarehouse_networkUnknownFailedMethodThree+
                                           this.i18ns.upgradePackageWarehouse.versionWarehouse_networkUnknownFailedMethodFour
                            this.iconClass=''

                    }
                }

            }
        });
    </script>
</body>

</html>