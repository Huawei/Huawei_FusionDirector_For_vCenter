<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>服务器信息</title>
    <link href="../../css/element.css" rel="stylesheet" />
    <link href="css/index.css" rel="stylesheet" />
    <link href="../../css/style.css" rel="stylesheet" />
    <link href="../../css/icommon.css" rel="stylesheet" />
    <script src="../../scripts/vue.js"></script>
    <script src="../../scripts/element.js"></script>
    <script src="../../scripts/jquery-3.2.1.min.js"></script>
    <script src="../../scripts/i18n/zh-CN.js"></script>
    <script src="../../scripts/i18n/en.js"></script>
    <script src="../i18n/en.js"></script>
    <script src="../i18n/zh-CN.js"></script>
    <script src="../../scripts/polyfill.min.js"></script>
    <script src="../js/common.js"></script>
    <script src="../../scripts/web-platform.js"></script>
    <script src="../js/errorCode.js"></script>
    <script src="../../scripts/lodash.min.js"></script>
    <script src="../../scripts/Chart.bundle.min.js"></script>
    <script src="js/data.js"></script>
    <script src="js/rest.js"></script>
    <style>
        [v-cloak] {
            display: none;
        }

        body {
            min-width: 900px;
        }

        .basicSeverinfo {
            border-collapse: collapse;
        }

        .basicSeverinfo tr td {
            border: 1px solid #dfe6ec;
            height: 30px;
            min-width: 150px;
            padding-left: 5px;
        }

        .basicSeverinfo tr td:nth-child(1),
        .basicSeverinfo tr td:nth-child(3) {
            background-color: #eef1f6;
            width: 150px;
        }

        .basicSeverinfo tr td:nth-child(2),
        .basicSeverinfo tr td:nth-child(4) {
            min-width: 270px;
        }

        .el-collapse {
            border: 1px solid #dfe6ec;
        }

        .el-collapse-item__header {
            padding-left: 5px;
        }

        .el-collapse-item__arrow {
            margin-right: 8px;
            float: left;
            font-weight: 400;
        }

        .pieChart {
            margin-top: 10px;
            max-width: 300px;
            min-width: 260px;
        }

        .pieChart .pieChart-content {
            display: flex;
            align-items: center;
            margin-top: 12px;
            margin-left: 30px;
        }

        .pieChart .pieChart-content span:nth-child(1) {
            line-height: 10px;
            padding-left: 3px;
        }

        .pieChart .pieChart-content span:nth-child(2) {
            line-height: 10px;
            padding-left: 10px;
            padding-right: 5px;
        }

        .pieChart pieChart-title {
            line-height: 10px;
            padding-left: 10px;
            padding-bottom: 20px;
            padding-top: 5px;
            font-size: 14px;
        }

        .pieChart pieChart-chart {
            height: 120px;
            width: 120px;
            margin-top: 15px;
            float: right;
        }

        .pieChart .pieChart-error {
            margin-top: 60px;
            text-align: center;
        }

        .normalClass {
            width: 10px;
            height: 10px;
            background-color: white;
            border: 2px #32CD32 solid;
            -webkit-border-radius: 8px;
            border-radius: 8px;
        }

        .warningClass {
            width: 10px;
            height: 10px;
            background-color: white;
            border: 2px #FFBB33 solid;
            -webkit-border-radius: 8px;
            border-radius: 8px;
        }

        .criticalClass {
            width: 10px;
            height: 10px;
            background-color: white;
            border: 2px #FF0000 solid;
            -webkit-border-radius: 8px;
            border-radius: 8px;
        }

        .unknownClass {
            width: 10px;
            height: 10px;
            background-color: white;
            border: 2px #4169E1 solid;
            -webkit-border-radius: 8px;
            border-radius: 8px;
        }

        .power-btn {
            position: relative;
            z-index: 2;
            top: 0;
            left: 0;
            float: right;
        }

        .el-tooltip__popper {
            line-height: 2;
        }
    </style>
</head>

<body>
    <div id="app" v-cloak>
        <div class="power-btn">
            <el-button type="danger" @click="dialogVisible = true">{{i18ns.server.frameManagement_openEndElectric}}
            </el-button>
        </div>
        <el-dialog :close-on-click-modal="false" :title="i18ns.server.frameManagement_openEndElectric"
            :visible.sync="dialogVisible" width="80%">
            <el-row style="margin-bottom: 8px;">
                <el-col :span="12">
                    <span>{{i18ns.server.frameManagement_deviceType}}: </span>
                    <el-select v-model="dialogDeviceType">
                        <el-option value="1" :label="i18ns.server.frameManagement_bladeServerResources"></el-option>
                    </el-select>
                </el-col>
                <el-col :span="12">
                    <span>{{i18ns.server.frameManagement_powerOperation}}: </span>
                    <el-select v-model="dialogPowerOperation" :placeholder="i18ns.common.pleaseSelect">
                        <el-option value="ForceOff" :label="i18ns.server.server_powerOff"></el-option>
                        <el-option value="On" :label="i18ns.server.server_powerOn"></el-option>
                    </el-select>
                </el-col>
            </el-row>
            <el-row>
                <el-table :data="dialogList" border style="width:100%;" header-row-class-name="my_table_header"
                    @selection-change="handleSelectionChange">
                    <el-table-column type="selection" width="55"></el-table-column>
                    <el-table-column prop="slotNumber" :label="i18ns.server.sn">
                        <template slot-scope="scope"> {{'Slot'+scope.row.Index}}</template>
                    </el-table-column>
                    <el-table-column prop="" :label="i18ns.server.name">
                        <template slot-scope="scope">{{scope.row.Name?scope.row.Name:'--'}}</template>
                    </el-table-column>
                    <el-table-column prop="" :label="i18ns.server.frameManagement_stateColon">
                        <template slot-scope="scope">
                            <span v-if="scope.row.PowerState=='On'">{{i18ns.server.server_electricityOn}}</span>
                            <span v-else>{{i18ns.server.server_electricityOff}}</span>
                        </template>
                    </el-table-column>
                    <!-- <el-table-column prop="" :label="i18ns.server.BMCIP">
                        <template slot-scope="scope">{{scope.row.IPv4Address?scope.row.IPv4Address.Address:'--'}}</template>
                    </el-table-column> -->
                </el-table>
            </el-row>
            <span slot="footer" class="dialog-footer">
                <el-button @click="dialogVisible = false">{{i18ns.common.cancel}}</el-button>
                <el-button type="primary" @click="resetServer()" :disabled="multipleSelection.length==0">
                    {{i18ns.common.confirm}}</el-button>
            </span>
        </el-dialog>
        <el-row v-loading.fullscreen.lock="fullscreenLoading " :element-loading-text="i18ns.common.loading">
            <table class="basicSeverinfo">
                <tr>
                    <td>{{i18ns.server.chassisName}}</td>
                    <td>{{severInfo.Name}}</td>
                    <td>{{i18ns.server.status}}</td>
                    <td>
                        {{getHealthStausTxt(severInfo.Health)}}
                    </td>
                </tr>
                <tr>
                    <td>{{i18ns.server.chassisType}}</td>
                    <td>{{severInfo.Type?severInfo.Type:'--'}}</td>
                    <td>{{i18ns.server.frameManagement_framePartNumber}}</td>
                    <td>{{severInfo.PartNumber?severInfo.PartNumber:'--'}}</td>
                </tr>

                <tr>
                    <td>{{i18ns.server.frameManagement_hostname}}</td>
                    <td>{{severInfo.Hostname?severInfo.Hostname:'--'}}</td>
                    <td>{{i18ns.server.chassisNo}}</td>
                    <td>{{severInfo.ChassisID?severInfo.ChassisID:'--'}}</td>
                </tr>
                <tr>
                    <td>{{i18ns.server.serialNumber}}</td>
                    <td>{{severInfo.SerialNumber?severInfo.SerialNumber:'--'}}</td>
                    <td>{{i18ns.server.frameManagement_createTime}}</td>
                    <td>{{severInfo.CreatedAt?severInfo.CreatedAt:'--'}}</td>
                </tr>
                <tr>
                    <td>{{i18ns.server.frameManagement_updateTime}}</td>
                    <td>{{severInfo.UpdatedAt?severInfo.UpdatedAt:'--'}}</td>
                    <td>{{i18ns.server.frameManagement_stateReason}}</td>
                    <td>{{stateAndStateReasonTxt}}</td>
                </tr>
                <tr>
                    <td>{{i18ns.server.description}}</td>
                    <td colspan="3">{{severInfo.Description?severInfo.Description:'--'}}</td>

                </tr>
            </table>
        </el-row>
        <el-row style="margin-top:8px;">
            <el-row class="frameViews" v-if="isShowView" style="width:920px;">
                <el-col :span="12">
                    <div class="frontView">
                        <div style="position: relative;">
                            <div class="frame-view-blade-background" v-if="serverViews.length>0"></div>
                            <div class="frontViewFont">{{i18ns.server.frameManagement_frontView}}</div>
                            <table>
                                <tr v-for="(item ,index) in serverViews">
                                    <td class="frame-view-glade-list-sm">
                                        {{item.slotIndex}}
                                    </td>
                                    <td v-if="item.left&&item.left.width==2" colspan="2"
                                        class="frame-view-glade-list-lg">
                                        <el-tooltip placement="right" :disabled="item.left.slotState=='Absent'">
                                            <div
                                                v-bind:class="{'frame-view-absent':item.left.slotState=='Absent','frame-view-enabled':item.left.slotState=='Enabled'}">
                                                <div class="frame-view-glade-div">
                                                    <span class="icon-plug frame-view-icon" style="color:#3dcda6;"
                                                        v-if="item.left.powerState=='On'"></span>
                                                    <span class="icon-plug_disconnect frame-view-icon"
                                                        style="color:#999999;"
                                                        v-if="item.left.powerState=='Off'"></span>

                                                    <span class='icon-success frame-view-icon' style="color: #3dcca6;"
                                                        v-if="item.left.health=='OK'&&item.left.serverState=='OnLine'"></span>
                                                    <span class="icon-s_vfailed frame-view-icon" style="color:#ffbb33;"
                                                        v-if="item.left.health=='Warning'&&item.left.serverState=='OnLine'"></span>
                                                    <span class="icon-s_vfailed frame-view-icon" style="color:#ff4c4c;"
                                                        v-if="item.left.health=='Critical'&&item.left.serverState=='OnLine'"></span>
                                                    <span class="icon-s_vfailed frame-view-icon" style="color:#dddddd;"
                                                        v-if="(item.left.health==''&&item.left.slotState=='Enabled')||item.left.serverState=='OffLine'||item.left.serverState=='Locked'"></span>
                                                    <span class="config-text">{{item.left.productName}}</span>
                                                </div>
                                            </div>
                                            <div slot="content" style="width: 280px;"
                                                v-bind:class="{'frame-view-absent-show':item.left.slotState=='Enabled'}">
                                                <div class="com-ti-form-one-xxxs form-change">
                                                    <el-row>
                                                        <el-col :span="10">{{i18ns.server.frameManagement_deviceName}}
                                                            :</el-col>
                                                        <el-col :span="14" style="color:#7ee6ce">
                                                            {{item.left.name?item.left.name:'--'}}</el-col>
                                                    </el-row>
                                                    <el-row>
                                                        <el-col :span="10">{{i18ns.server.frameManagement_deviceType}}
                                                            :</el-col>
                                                        <el-col :span="14">
                                                            {{item.left.productName?item.left.productName:'--'}}
                                                        </el-col>
                                                    </el-row>
                                                    <el-row>
                                                        <el-col :span="10">{{i18ns.server.slotNumber}} :</el-col>
                                                        <el-col :span="14">{{'Slot'+item.left.slot}}</el-col>
                                                    </el-row>
                                                    <el-row>
                                                        <el-col :span="10">{{i18ns.server.frameManagement_powerStatus}}
                                                            :</el-col>
                                                        <el-col :span="14">{{getPowerState(item.left.powerState)}}
                                                        </el-col>
                                                    </el-row>
                                                    <el-row>
                                                        <el-col :span="10">{{i18ns.server.healthStatus}} :</el-col>
                                                        <el-col :span="14">
                                                            {{getChildSeverHealthStatusTxt(item.left.health)}}</el-col>
                                                    </el-row>
                                                    <el-row>
                                                        <el-col :span="10">
                                                            {{i18ns.server.frameManagement_mainBoardSerialNumber}}
                                                            :</el-col>
                                                        <el-col :span="14">
                                                            {{item.left.serialNumber?item.left.serialNumber:'--'}}
                                                        </el-col>
                                                    </el-row>
                                                    <el-row>
                                                        <el-col :span="10">{{i18ns.server.BMCIP}} :</el-col>
                                                        <el-col :span="14">{{item.left.BMCIP?item.left.BMCIP:'--'}}
                                                        </el-col>
                                                    </el-row>
                                                </div>
                                            </div>
                                        </el-tooltip>
                                    </td>
                                    <td v-if="item.left&&item.left.width==1" class="frame-view-glade-list-md"
                                        v-bind:class="{'frame-view-border-bottom':item.left.slot==1,'frame-view-border-top':item.left.slot==8}">
                                        <el-tooltip placement="right" :disabled="item.left.slotState=='Absent'">
                                            <div
                                                v-bind:class="{'frame-view-absent':item.left.slotState=='Absent','frame-view-enabled':item.left.slotState=='Enabled'}">
                                                <div class="frame-view-glade-div">
                                                    <span class="icon-plug frame-view-icon" style="color:#3dcda6;"
                                                        v-if="item.left.powerState=='On'"></span>
                                                    <span class="icon-plug_disconnect frame-view-icon"
                                                        style="color:#999999;"
                                                        v-if="item.left.powerState=='Off'"></span>
                                                    <span class='icon-success frame-view-icon' style="color: #3dcca6;"
                                                        v-if="item.left.health=='OK'&&item.left.serverState=='OnLine'"></span>
                                                    <span class="icon-s_vfailed frame-view-icon" style="color:#ffbb33;"
                                                        v-if="item.left.health=='Warning'&&item.left.serverState=='OnLine'"></span>
                                                    <span class="icon-s_vfailed frame-view-icon" style="color:#ff4c4c;"
                                                        v-if="item.left.health=='Critical'&&item.left.serverState=='OnLine'"></span>
                                                    <span class="icon-s_vfailed frame-view-icon" style="color:#dddddd;"
                                                        v-if="(item.left.health==''&&item.left.slotState=='Enabled')||item.left.serverState=='OffLine'||item.left.serverState=='Locked'"></span>
                                                    <span class="config-text">{{item.left.productName}}</span>
                                                </div>
                                            </div>
                                            <div slot="content" style="width: 280px;"
                                                v-bind:class="{'frame-view-absent-show':item.left.slotState=='Enabled'}">
                                                <div class="com-ti-form-one-xxxs form-change">
                                                    <el-row>
                                                        <el-col :span="10">{{i18ns.server.frameManagement_deviceName}}
                                                            :</el-col>
                                                        <el-col :span="14" style="color:#7ee6ce">
                                                            {{item.left.name?item.left.name:'--'}}</el-col>
                                                    </el-row>
                                                    <el-row>
                                                        <el-col :span="10">{{i18ns.server.frameManagement_deviceType}}
                                                            :</el-col>
                                                        <el-col :span="14">
                                                            {{item.left.productName?item.left.productName:'--'}}
                                                        </el-col>
                                                    </el-row>
                                                    <el-row>
                                                        <el-col :span="10">{{i18ns.server.slotNumber}} :</el-col>
                                                        <el-col :span="14">{{'Slot'+item.left.slot}}</el-col>
                                                    </el-row>
                                                    <el-row>
                                                        <el-col :span="10">{{i18ns.server.frameManagement_powerStatus}}
                                                            :</el-col>
                                                        <el-col :span="14">{{getPowerState(item.left.powerState)}}
                                                        </el-col>
                                                    </el-row>
                                                    <el-row>
                                                        <el-col :span="10">{{i18ns.server.healthStatus}} :</el-col>
                                                        <el-col :span="14">
                                                            {{getChildSeverHealthStatusTxt(item.left.health)}}</el-col>
                                                    </el-row>
                                                    <el-row>
                                                        <el-col :span="10">
                                                            {{i18ns.server.frameManagement_mainBoardSerialNumber}}
                                                            :</el-col>
                                                        <el-col :span="14">
                                                            {{item.left.serialNumber?item.left.serialNumber:'--'}}
                                                        </el-col>
                                                    </el-row>
                                                    <el-row>
                                                        <el-col :span="10">{{i18ns.server.BMCIP}} :</el-col>
                                                        <el-col :span="14">{{item.left.BMCIP?item.left.BMCIP:'--'}}
                                                        </el-col>
                                                    </el-row>
                                                </div>
                                            </div>
                                        </el-tooltip>
                                    </td>
                                    <td v-if="item.left&&item.left.width==1" class="frame-view-glade-list-md"
                                        v-bind:class="{'frame-view-border-bottom':item.right.slot==1,'frame-view-border-top':item.right.slot==8}">
                                        <el-tooltip placement="right" :disabled="item.right.slotState=='Absent'">
                                            <div
                                                v-bind:class="{'frame-view-absent':item.right.slotState=='Absent','frame-view-enabled':item.right.slotState=='Enabled'}">
                                                <div class="frame-view-glade-div">
                                                    <span class="icon-plug frame-view-icon" style="color:#3dcda6;"
                                                        v-if="item.right.powerState=='On'"></span>
                                                    <span class="icon-plug_disconnect frame-view-icon"
                                                        style="color:#999999;"
                                                        v-if="item.right.powerState=='Off'"></span>
                                                    <span class='icon-success frame-view-icon' style="color: #3dcca6;"
                                                        v-if="item.right.health=='OK'&&item.right.serverState=='OnLine'"></span>
                                                    <span class="icon-s_vfailed frame-view-icon" style="color:#ffbb33;"
                                                        v-if="item.right.health=='Warning'&&item.right.serverState=='OnLine'"></span>
                                                    <span class="icon-s_vfailed frame-view-icon" style="color:#ff4c4c;"
                                                        v-if="item.right.health=='Critical'&&item.right.serverState=='OnLine'"></span>
                                                    <span class="icon-s_vfailed frame-view-icon" style="color:#dddddd;"
                                                        v-if="(item.right.health==''&&item.right.slotState=='Enabled')||item.right.serverState=='OffLine'||item.right.serverState=='Locked'"></span>
                                                    <span class="config-text">{{item.right.productName}}</span>
                                                </div>
                                            </div>
                                            <div slot="content" style="width: 280px;"
                                                v-bind:class="{'frame-view-absent-show':item.right.slotState=='Enabled'}">
                                                <div>
                                                    <el-row>
                                                        <el-col :span="10">{{i18ns.server.frameManagement_deviceName}}
                                                            :</el-col>
                                                        <el-col :span="14" style="color:#7ee6ce">
                                                            {{item.right.name?item.right.name:'--'}}</el-col>
                                                    </el-row>
                                                    <el-row>
                                                        <el-col :span="10">{{i18ns.server.frameManagement_deviceType}}
                                                            :</el-col>
                                                        <el-col :span="14">
                                                            {{item.right.productName?item.right.productName:'--'}}
                                                        </el-col>
                                                    </el-row>
                                                    <el-row>
                                                        <el-col :span="10">{{i18ns.server.slotNumber}} :</el-col>
                                                        <el-col :span="14">{{'Slot'+item.right.slot}}</el-col>
                                                    </el-row>
                                                    <el-row>
                                                        <el-col :span="10">{{i18ns.server.frameManagement_powerStatus}}
                                                            :</el-col>
                                                        <el-col :span="14">
                                                            {{item.right.powerState=='On'?i18ns.server.server_electricityOn:i18ns.server.server_electricityOff}}
                                                        </el-col>
                                                    </el-row>
                                                    <el-row>
                                                        <el-col :span="10">{{i18ns.server.healthStatus}} :</el-col>
                                                        <el-col :span="14">
                                                            {{getChildSeverHealthStatusTxt(item.right.health)}}</el-col>
                                                    </el-row>
                                                    <el-row>
                                                        <el-col :span="10">
                                                            {{i18ns.server.frameManagement_mainBoardSerialNumber}}
                                                            :</el-col>
                                                        <el-col :span="14">
                                                            {{item.right.serialNumber?item.right.serialNumber:'--'}}
                                                        </el-col>
                                                    </el-row>
                                                    <el-row>
                                                        <el-col :span="10">{{i18ns.server.BMCIP}} :</el-col>
                                                        <el-col :span="14">{{item.right.BMCIP?item.right.BMCIP:'--'}}
                                                        </el-col>
                                                    </el-row>

                                                </div>
                                            </div>
                                        </el-tooltip>
                                    </td>
                                    <td class="frame-view-glade-list-sm">
                                        {{8+item.slotIndex}}
                                    </td>
                                </tr>
                            </table>
                            <div class="frame-view-light-div">
                                <span>UID</span>
                                <div class="frame-view-light" v-bind:class="{'frame-view-light-lit':severInfo.UIDState=='Lit',
                                                                 'frame-view-light-off':severInfo.UIDState=='Off'}">
                                </div>
                                <span>HLY</span>
                                <div class="frame-view-light"
                                    v-bind:class="{'frame-view-light-OK':severInfo.Health=='OK',
                                                                 'frame-view-light-Warning':severInfo.Health=='Warning',
                                                                 'frame-view-light-Critical':severInfo.Health=='Critical'}">
                                </div>
                            </div>
                        </div>
                    </div>
                </el-col>
                <el-col :span="12">
                    <div class="postView">
                        <nav class="postViewFont">{{i18ns.server.frameManagement_postView}}</nav>
                        <div class="postViewImage clearfix">
                            <ol class="framePowerLeftView">
                                <li class="powerDiv" v-for="power in frameLeftPowerList"
                                    v-bind:class="{'absentStyle':power.State=='Absent','powerDivEnable':power.State=='Enabled'}">
                                    <el-tooltip placement="left" :disabled="power.State=='Absent'">
                                        <div class="power-div">
                                            <span class='icon-success successDevice frame-view-icon-heath'
                                                style="color:#3dcda6;"
                                                v-if="power.Health=='OK'&&power.State=='Enabled'"></span>
                                            <span class="icon-s_vfailed frame-view-icon-heath heath-icon"
                                                style="color:#ffbb33;"
                                                v-if="power.Health=='Warning'&&power.State=='Enabled'"></span>
                                            <span class="icon-s_vfailed frame-view-icon-heath heath-icon"
                                                style="color:#ff4c4c;"
                                                v-if="power.Health=='Critical'&&power.State=='Enabled'"></span>
                                            <span class="icon-s_vfailed frame-view-icon-heath heath-icont"
                                                style="color:#dddddd;"
                                                v-if="power.Health==''&&power.State=='Enabled'"></span>
                                            <div class="powerPSU" v-if="power.State=='Enabled'"></div>
                                            <div class="PSUFont frame-view-font-size" v-if="power.State=='Enabled'">{{"PSU"
                                                +
                                                power.Index}}
                                            </div>
                                        </div>
                                        <div slot="content" style="width: 200px;">
                                            <div class="com-ti-form-one-xxxs form-change">
                                                <el-row>
                                                    <el-col :span="14">{{i18ns.server.frameManagement_deviceName}} :
                                                    </el-col>
                                                    <el-col :span="10" style="color:#7ee6ce">{{'PSU' + power.Index}}
                                                    </el-col>
                                                </el-row>
                                                <el-row>
                                                    <el-col :span="14">{{i18ns.server.frameManagement_deviceType}} :
                                                    </el-col>
                                                    <el-col :span="10">{{power.PowerSupplyType}}</el-col>
                                                </el-row>
                                                <el-row>
                                                    <el-col :span="14">{{i18ns.server.slotNumber}} :</el-col>
                                                    <el-col :span="10">{{'PSU'+power.Index}}</el-col>
                                                </el-row>
                                                <el-row>
                                                    <el-col :span="14">{{i18ns.server.healthStatus}} :</el-col>
                                                    <el-col :span="10"> {{getHealthStausTxt(power.Health)}}</el-col>
                                                </el-row>
                                                <el-row>
                                                    <el-col :span="14">{{i18ns.server.ratedPower}}
                                                        :</el-col>
                                                    <el-col :span="10">{{power.PowerCapacityWatts+'W'}}</el-col>
                                                </el-row>
                                                <el-row>
                                                    <el-col :span="14">{{i18ns.server.hardwareVersion}} :</el-col>
                                                    <el-col :span="10">{{power.HardwareVersion}}</el-col>
                                                </el-row>
                                            </div>
                                        </div>
                                    </el-tooltip>
                                </li>
                            </ol>
                            <ol class="frameFanLeftView">
                                <li class="fanDiv" v-for="fan in frameLeftFanList"
                                    v-bind:class="{'absentStyle':fan.State=='Absent','fanDivEnable':fan.State=='Enabled'}">
                                    <el-tooltip placement="left" :disabled="fan.State=='Absent'">
                                        <div style="height:60px;width:100%;" class="fan-div">
                                            <span class='icon-success successDevice frame-view-icon-heath'
                                                style="color:#3dcda6;"
                                                v-if="fan.Health=='OK'&&fan.State=='Enabled'"></span>
                                            <span class="icon-s_vfailed frame-view-icon-heath heath-icon"
                                                style="color:#ffbb33;"
                                                v-if="fan.Health=='Warning'&&fan.State=='Enabled'"></span>
                                            <span class="icon-s_vfailed frame-view-icon-heath heath-icon"
                                                style="color:#ff4c4c;"
                                                v-if="fan.Health=='Critical'&&fan.State=='Enabled'"></span>
                                            <span class="icon-s_vfailed frame-view-icon-heath heath-icon"
                                                style="color:#dddddd;"
                                                v-if="fan.Health==''&&fan.State=='Enabled'"></span>
                                            <div v-if="fan.State=='Enabled'" class="frame-view-font-size">
                                                {{'Fan'+fan.Index}}</div>
                                        </div>
                                        <div slot="content" style="width: 200px;">
                                            <div class="com-ti-form-one-xxxs form-change">
                                                <el-row>
                                                    <el-col :span="14">{{i18ns.server.frameManagement_deviceName}} :
                                                    </el-col>
                                                    <el-col :span="10" style="color:#7ee6ce">{{'Fan' + fan.Index}}
                                                    </el-col>
                                                </el-row>
                                                <el-row>
                                                    <el-col :span="14">{{i18ns.server.frameManagement_deviceModel}} :
                                                    </el-col>
                                                    <el-col :span="10">Fan</el-col>
                                                </el-row>
                                                <el-row>
                                                    <el-col :span="14">{{i18ns.server.slotNumber}} :</el-col>
                                                    <el-col :span="10">{{'Fan'+fan.Index}}</el-col>
                                                </el-row>
                                                <el-row>
                                                    <el-col :span="14">{{i18ns.server.healthStatus}} :</el-col>
                                                    <el-col :span="10"> {{fan.Health?getHealthStausTxt(fan.Health):''}}
                                                    </el-col>

                                                </el-row>
                                            </div>
                                        </div>
                                    </el-tooltip>
                                </li>
                            </ol>
                            <div class="switchView">
                                <div class="fanDiv pull-left" v-for="(fan,index) in frameTopFanList"
                                    v-bind:class="{'absentStyle':fan.State=='Absent','fanDivEnable':fan.State=='Enabled','floatLeft':index==0,'floatRight':index==1}">
                                    <el-tooltip placement="left" :disabled="fan.State=='Absent'">
                                        <div style="height:60px;width:100%;text-align: center;" class="fan-div">
                                            <span class='icon-success successDevice frame-view-icon-heath'
                                                style="color:#3dcda6;"
                                                v-if="fan.Health=='OK'&&fan.State=='Enabled'"></span>
                                            <span class="icon-s_vfailed frame-view-icon-heath heath-icon"
                                                style="color:#ffbb33;"
                                                v-if="fan.Health=='Warning'&&fan.State=='Enabled'"></span>
                                            <span class="icon-s_vfailed frame-view-icon-heath heath-icon"
                                                style="color:#ff4c4c;"
                                                v-if="fan.Health=='Critical'&&fan.State=='Enabled'"></span>
                                            <span class="icon-s_vfailed frame-view-icon-heath heath-icon"
                                                style="color:#dddddd;"
                                                v-if="fan.Health==''&&fan.State=='Enabled'"></span>
                                            <div v-if="fan.State=='Enabled'" class="frame-view-font-size">
                                                {{'Fan'+fan.Index}}</div>
                                        </div>
                                        <div slot="content" style="width: 200px;">
                                            <div class="com-ti-form-one-xxxs form-change">
                                                <el-row>
                                                    <el-col :span="14">{{i18ns.server.frameManagement_deviceName}} :
                                                    </el-col>
                                                    <el-col :span="10" style="color:#7ee6ce">{{'Fan' + fan.Index}}
                                                    </el-col>
                                                </el-row>
                                                <el-row>
                                                    <el-col :span="14">{{i18ns.server.frameManagement_deviceModel}} :
                                                    </el-col>
                                                    <el-col :span="10">Fan</el-col>
                                                </el-row>
                                                <el-row>
                                                    <el-col :span="14">{{i18ns.server.slotNumber}} :</el-col>
                                                    <el-col :span="10">{{'Fan'+fan.Index}}</el-col>
                                                </el-row>
                                                <el-row>
                                                    <el-col :span="14">{{i18ns.server.healthStatus}} :</el-col>
                                                    <el-col :span="10"> {{getHealthStausTxt(fan.Health)}}</el-col>
                                                </el-row>
                                            </div>
                                        </div>
                                    </el-tooltip>
                                </div>
                                <div class="switchPanelRegional">
                                    <!--管理板-->
                                    <div class="managementBoard">
                                        <div class="managementPanel"
                                            v-bind:class="{'absentStyle':frameManagementPanel2[0].State=='Absent',
                                                                'managementPanelEnable':frameManagementPanel2[0].State=='Enabled'||frameManagementPanel2[0].State=='StandbySpare'}">
                                            <el-tooltip placement="left"
                                                :disabled="frameManagementPanel2[0].State=='Absent'">
                                                <div class="manager-div">
                                                    <span class="frame-view-manager-light"
                                                        v-bind:class="{'frame-view-manager-light-open':frameManagementPanel2[0].State=='Enabled'}"
                                                        v-if="frameManagementPanel2[0].State=='Enabled'||frameManagementPanel2[0].State=='StandbySpare'"></span>

                                                    <div class="frame-view-manager-heath">
                                                        <span class='icon-success successDevice frame-view-icon-heath'
                                                            style="color:#3dcda6;"
                                                            v-if="frameManagementPanel2[0].Health=='OK'"></span>
                                                        <span class="icon-s_vfailed frame-view-icon-heath heath-icon"
                                                            style="color:#ffbb33;"
                                                            v-if="frameManagementPanel2[0].Health=='Warning'"></span>
                                                        <span class="icon-s_vfailed frame-view-icon-heath heath-icon"
                                                            style="color:#ff4c4c;"
                                                            v-if="frameManagementPanel2[0].Health=='Critical'"></span>
                                                        <span class="icon-s_vfailed frame-view-icon-heath heath-icon"
                                                            style="color:#dddddd;"
                                                            v-if="frameManagementPanel2[0].Health==''&&frameManagementPanel2[0].State=='Enabled'"></span>
                                                    </div>

                                                    <span
                                                        v-if="frameManagementPanel2[0].State=='Enabled'||frameManagementPanel2[0].State=='StandbySpare'"
                                                        class="frame-view-manager-font">MM2</span>
                                                </div>
                                                <div slot="content" style="width: 280px;">
                                                    <div class="com-ti-form-one-xxxs form-change">
                                                        <el-row>
                                                            <el-col :span="16">
                                                                {{i18ns.server.frameManagement_deviceName}}
                                                                :</el-col>
                                                            <el-col :span="8" style="color:#7ee6ce">
                                                                {{frameManagementPanel2[0].ProductName}}</el-col>
                                                        </el-row>
                                                        <el-row>
                                                            <el-col :span="16">
                                                                {{i18ns.server.frameManagement_deviceType}}
                                                                :</el-col>
                                                            <el-col :span="8">MM2</el-col>
                                                        </el-row>
                                                        <el-row>
                                                            <el-col :span="16">{{i18ns.server.slotNumber}} :</el-col>
                                                            <el-col :span="8">{{frameManagementPanel2[0].Index}}
                                                            </el-col>
                                                        </el-row>
                                                        <el-row>
                                                            <el-col :span="16">{{i18ns.server.healthStatus}} :</el-col>
                                                            <el-col :span="8">
                                                                {{getHealthStausTxt(frameManagementPanel2[0].Health)}}
                                                            </el-col>
                                                        </el-row>
                                                        <el-row>
                                                            <el-col :span="16">{{i18ns.server.managerLink}}
                                                                :</el-col>
                                                            <el-col :span="8">
                                                                {{getActiveStandbyTxt(frameManagementPanel2[0].State)}}
                                                            </el-col>
                                                        </el-row>
                                                        <el-row>
                                                            <el-col :span="16">
                                                                {{i18ns.server.frameManagement_mainBoardSerialNumber}}
                                                                :</el-col>
                                                            <el-col :span="8">{{frameManagementPanel2[0].SerialNumber}}
                                                            </el-col>
                                                        </el-row>
                                                    </div>
                                                </div>
                                            </el-tooltip>
                                        </div>
                                        <div class="managementPanel"
                                            v-bind:class="{'absentStyle':frameManagementPanel1[0].State=='Absent',
                                                                 'managementPanelEnable':frameManagementPanel1[0].State=='Enabled'||frameManagementPanel1[0].State=='StandbySpare'}">
                                            <el-tooltip placement="left"
                                                :disabled="frameManagementPanel1[0].State=='Absent'">
                                                <div class="manager-div">
                                                    <span class="frame-view-manager-light"
                                                        v-bind:class="{'frame-view-manager-light-open':frameManagementPanel1[0].State=='Enabled'}"
                                                        v-if="frameManagementPanel1[0].State=='Enabled'||frameManagementPanel1[0].State=='StandbySpare'"></span>
                                                    <div class="frame-view-manager-heath">
                                                        <span class='icon-success successDevice frame-view-icon-heath'
                                                            style="color:#3dcda6;"
                                                            v-if="frameManagementPanel1[0].Health=='OK'"></span>
                                                        <span class="icon-s_vfailed frame-view-icon-heath heath-iconv"
                                                            style="color:#ffbb33;"
                                                            v-if="frameManagementPanel1[0].Health=='Warning'"></span>
                                                        <span class="icon-s_vfailed frame-view-icon-heath heath-icon"
                                                            style="color:#ff4c4c;"
                                                            v-if="frameManagementPanel1[0].Health=='Critical'"></span>
                                                        <span class="icon-s_vfailed frame-view-icon-heath heath-icon"
                                                            style="color:#dddddd;"
                                                            v-if="frameManagementPanel1[0].Health==''&&frameManagementPanel1[0].State=='Enabled'"></span>
                                                    </div>
                                                    <span
                                                        v-if="frameManagementPanel1[0].State=='Enabled'||frameManagementPanel1[0].State=='StandbySpare'"
                                                        class="frame-view-manager-font">MM1</span>
                                                </div>
                                                <div slot="content" style="width: 280px;">
                                                    <div class="com-ti-form-one-xxxs form-change">
                                                        <el-row>
                                                            <el-col :span="16">
                                                                {{i18ns.server.frameManagement_deviceName}}
                                                                :</el-col>
                                                            <el-col :span="8" style="color:#7ee6ce">
                                                                {{frameManagementPanel1[0].ProductName}}</el-col>
                                                        </el-row>
                                                        <el-row>
                                                            <el-col :span="16">
                                                                {{i18ns.server.frameManagement_deviceType}}
                                                                :</el-col>
                                                            <el-col :span="8">MM1</el-col>
                                                        </el-row>
                                                        <el-row>
                                                            <el-col :span="16">{{i18ns.server.slotNumber}} :</el-col>
                                                            <el-col :span="8">{{frameManagementPanel1[0].Index}}
                                                            </el-col>
                                                        </el-row>
                                                        <el-row>
                                                            <el-col :span="16">{{i18ns.server.healthStatus}} :</el-col>
                                                            <el-col :span="8">
                                                                {{getHealthStausTxt(frameManagementPanel1[0].Health)}}
                                                            </el-col>
                                                        </el-row>
                                                        <el-row>
                                                            <el-col :span="16">{{i18ns.server.managerLink}}
                                                                :</el-col>
                                                            <el-col :span="8">
                                                                {{getActiveStandbyTxt(frameManagementPanel1[0].State)}}
                                                            </el-col>
                                                        </el-row>
                                                        <el-row>
                                                            <el-col :span="16">
                                                                {{i18ns.server.frameManagement_mainBoardSerialNumber}}
                                                                :</el-col>
                                                            <el-col :span="8">{{frameManagementPanel1[0].SerialNumber}}
                                                            </el-col>
                                                        </el-row>
                                                    </div>
                                                </div>
                                            </el-tooltip>
                                        </div>
                                    </div>
                                    <!--交换板-->

                                    <div v-for="(item , index) in switchPanelList">
                                        <el-tooltip placement="left" :disabled="item.State=='Absent'">
                                            <div class="switchPanel" v-bind:class="{
                                                'switch320 switchHoverImage':item.State=='Enabled'&&item.ProductName=='CX320',
                                                'switch710 switchHoverImage':item.State=='Enabled'&&item.ProductName=='CX710',
                                                'switch916 switchHoverImage':item.State=='Enabled'&&item.ProductName=='CX916',
                                                'switch916L switchHoverImage':item.State=='Enabled'&&item.ProductName=='CX916L',
                                                'switch920 switchHoverImage':item.State=='Enabled'&&item.ProductName=='CX920',
                                                'absentStyle':item.State=='Absent',
                                            'first':index==0}">
                                                <div class="frame-view-switch-heath">
                                                    <span class='icon-success successDevice frame-view-icon-heath'
                                                        style="color:#3dcda6;"
                                                        v-if="item.Health=='OK'&&item.SwitchState!=='OffLine'"></span>
                                                    <span class="icon-s_vfailed frame-view-icon-heath heath-icon"
                                                        style="color:#ffbb33;"
                                                        v-if="item.Health=='Warning'&&item.SwitchState!=='OffLine'"></span>
                                                    <span class="icon-s_vfailed frame-view-icon-heath heath-icon"
                                                        style="color:#ff4c4c;"
                                                        v-if="item.Health=='Critical'&&item.SwitchState!=='OffLine'"></span>
                                                    <span class="icon-s_vfailed frame-view-icon-heath heath-icon"
                                                        style="color:#dddddd;"
                                                        v-if="(item.Health==''&&item.State=='Enabled')||item.SwitchState=='OffLine'"></span>

                                                </div>
                                                <span
                                                    class="frame-view-switch-product">{{item.State=='Enabled'?item.ProductName:''}}</span>

                                            </div>
                                            <div slot="content" style="width: 320px;">
                                                <div class="com-ti-form-one-xxxs form-change">
                                                    <el-row>
                                                        <el-col :span="12">{{i18ns.server.frameManagement_deviceName}}
                                                            :</el-col>
                                                        <el-col :span="12" style="color:#7ee6ce">{{item.ProductName}}
                                                        </el-col>
                                                    </el-row>

                                                    <el-row>
                                                        <el-col :span="12">{{i18ns.server.slotNumber}} :</el-col>
                                                        <el-col :span="12">
                                                            <span v-if="item.Index=='1'">1E</span>
                                                            <span v-if="item.Index=='2'">2X</span>
                                                            <span v-if="item.Index=='3'">3X</span>
                                                            <span v-if="item.Index=='4'">4E</span>
                                                        </el-col>
                                                    </el-row>
                                                    <el-row>
                                                        <el-col :span="12">{{i18ns.server.healthStatus}} :</el-col>
                                                        <el-col :span="12">
                                                            <span>{{getSwitchTxt(item.SwitchState,item.Health)}}</span>
                                                        </el-col>
                                                    </el-row>
                                                    <el-row>
                                                        <el-col :span="12">
                                                            {{i18ns.server.frameManagement_mainBoardSerialNumber}}
                                                            :</el-col>
                                                        <el-col :span="12">{{item.SerialNumber}}</el-col>
                                                    </el-row>
                                                    <el-row>
                                                        <el-col :span="12">{{i18ns.server.BMCIP}}
                                                            :</el-col>
                                                        <el-col :span="12">{{item.BMCIP?item.BMCIP:'--'}}</el-col>
                                                    </el-row>
                                                    <el-row>
                                                        <el-col :span="12">
                                                            {{i18ns.server.frameManagement_flexibleCardsOneName}}
                                                            :</el-col>
                                                        <el-col :span="12">{{item.flexName1==''?'--':item.flexName1}}
                                                        </el-col>
                                                    </el-row>
                                                    <el-row>
                                                        <el-col :span="12">
                                                            {{i18ns.server.frameManagement_flexibleCardsOneNum}}
                                                            :</el-col>
                                                        <el-col :span="12">
                                                            {{item.flexSerialNumber1==''?'--':item.flexSerialNumber1}}
                                                        </el-col>
                                                    </el-row>
                                                    <el-row>
                                                        <el-col :span="12">
                                                            {{i18ns.server.frameManagement_flexibleCardsTwoName}}
                                                            :</el-col>
                                                        <el-col :span="12">{{item.flexName2==''?'--':item.flexName2}}
                                                        </el-col>
                                                    </el-row>
                                                    <el-row>
                                                        <el-col :span="12">
                                                            {{i18ns.server.frameManagement_flexibleCardsTwoNum}}
                                                            :</el-col>
                                                        <el-col :span="12">
                                                            {{item.flexSerialNumber2==''?'--':item.flexSerialNumber2}}
                                                        </el-col>
                                                    </el-row>
                                                </div>
                                            </div>
                                        </el-tooltip>
                                    </div>

                                </div>
                            </div>
                            <ol class="frameFanRightView">
                                <li class="fanDiv" v-for="fan in frameRightFanList"
                                    v-bind:class="{'absentStyle':fan.State=='Absent','fanDivEnable':fan.State=='Enabled'}">
                                    <el-tooltip placement="left" :disabled="fan.State=='Absent'">
                                        <div style="height:60px;width:100%;" class="fan-div">
                                            <span class='icon-success successDevice frame-view-icon-heath'
                                                style="color:#3dcda6;"
                                                v-if="fan.Health=='OK'&&fan.State=='Enabled'"></span>
                                            <span class="icon-s_vfailed frame-view-icon-heath heath-icon"
                                                style="color:#ffbb33;"
                                                v-if="fan.Health=='Warning' &&fan.State=='Enabled'"></span>
                                            <span class="icon-s_vfailed frame-view-icon-heath heath-icon"
                                                style="color:#ff4c4c;"
                                                v-if="fan.Health=='Critical' &&fan.State=='Enabled'"></span>
                                            <span class="icon-s_vfailed frame-view-icon-heath heath-icon"
                                                style="color:#dddddd;"
                                                v-if="fan.Health==''&&fan.State=='Enabled'"></span>
                                            <div v-if="fan.State=='Enabled'" class="frame-view-font-size">
                                                {{'Fan'+fan.Index}}</div>
                                        </div>
                                        <div slot="content" style="width: 200px;">
                                            <div class="com-ti-form-one-xxxs form-change">
                                                <el-row>
                                                    <el-col :span="14">{{i18ns.server.frameManagement_deviceName}} :
                                                    </el-col>
                                                    <el-col :span="10" style="color:#7ee6ce">{{'Fan' + fan.Index}}
                                                    </el-col>
                                                </el-row>
                                                <el-row>
                                                    <el-col :span="14">{{i18ns.server.frameManagement_deviceModel}} :
                                                    </el-col>
                                                    <el-col :span="10">Fan</el-col>
                                                </el-row>
                                                <el-row>
                                                    <el-col :span="14">{{i18ns.server.slotNumber}} :</el-col>
                                                    <el-col :span="10">{{'Fan'+fan.Index}}</el-col>
                                                </el-row>
                                                <el-row>
                                                    <el-col :span="14">{{i18ns.server.healthStatus}} :</el-col>
                                                    <el-col :span="10"> {{getHealthStausTxt(fan.Health)}}</el-col>
                                                </el-row>
                                            </div>
                                        </div>
                                    </el-tooltip>
                                </li>
                            </ol>
                            <ol class="framePowerRightView">
                                <li class="powerDiv" v-for="power in frameRightPowerList"
                                    v-bind:class="{'absentStyle':power.State=='Absent','powerDivEnable':power.State=='Enabled'}">
                                    <el-tooltip placement="left" :disabled="power.State=='Absent'">
                                        <div class="power-div">
                                            <span class='icon-success successDevice frame-view-icon-heath'
                                                style="color:#3dcda6;"
                                                v-if="power.Health=='OK'&&power.State=='Enabled'"></span>
                                            <span class="icon-s_vfailed frame-view-icon-heath heath-icon"
                                                style="color:#ffbb33;"
                                                v-if="power.Health=='Warning'&&power.State=='Enabled'"></span>
                                            <span class="icon-s_vfailed frame-view-icon-heath heath-icon"
                                                style="color:#ff4c4c;"
                                                v-if="power.Health=='Critical'&&power.State=='Enabled'"></span>
                                            <span class="icon-s_vfailed frame-view-icon-heath heath-icon"
                                                style="color:#dddddd;"
                                                v-if="power.Health==''&&power.State=='Enabled'"></span>
                                            <div class="powerPSU" v-if="power.State=='Enabled'"></div>
                                            <div class="PSUFont frame-view-font-size" v-if="power.State=='Enabled'">
                                                {{"PSU"+power.Index}}
                                            </div>
                                        </div>
                                        <div slot="content" style="width: 200px;">
                                            <div class="com-ti-form-one-xxxs form-change">
                                                <el-row>
                                                    <el-col :span="14">{{i18ns.server.frameManagement_deviceName}} :
                                                    </el-col>
                                                    <el-col :span="10" style="color:#7ee6ce">{{'PSU' + power.Index}}
                                                    </el-col>
                                                </el-row>
                                                <el-row>
                                                    <el-col :span="14">{{i18ns.server.frameManagement_deviceType}} :
                                                    </el-col>
                                                    <el-col :span="10">{{power.PowerSupplyType}}</el-col>
                                                </el-row>
                                                <el-row>
                                                    <el-col :span="14">{{i18ns.server.slotNumber}} :</el-col>
                                                    <el-col :span="10">{{'PSU'+power.Index}}</el-col>
                                                </el-row>
                                                <el-row>
                                                    <el-col :span="14">{{i18ns.server.healthStatus}} :</el-col>
                                                    <el-col :span="10"> {{getHealthStausTxt(power.Health)}}</el-col>
                                                </el-row>
                                                <el-row>
                                                    <el-col :span="14">{{i18ns.server.ratedPower}}
                                                        :</el-col>
                                                    <el-col :span="10">{{power.PowerCapacityWatts+'W'}}</el-col>
                                                </el-row>
                                                <el-row>
                                                    <el-col :span="14">{{i18ns.server.hardwareVersion}} :</el-col>
                                                    <el-col :span="10">{{power.HardwareVersion}}</el-col>
                                                </el-row>
                                            </div>
                                        </div>
                                    </el-tooltip>
                                </li>
                            </ol>
                        </div>
                        <div class="frame-view-back-bottom">
                            <span style="margin-left:19px;">1E</span>
                            <span>2X</span>
                            <span>3X</span>
                            <span>4E</span>
                        </div>
                    </div>
                </el-col>
            </el-row>
        </el-row>
        <el-row style="margin-top:8px;">
            <el-collapse v-model="activeNames">
                <!-- 管理板列表 -->
                <el-collapse-item :title="i18ns.server.managementMoudule" name="manager">
                    <el-table :data="managerList" border style="width:100%;" v-loading="managerLoading"
                        :element-loading-text="i18ns.common.loading" header-row-class-name="my_table_header">
                        <el-table-column prop="Index" :label="i18ns.server.slotNumber">
                            <template slot-scope="scope">
                                {{'MM'+scope.row.Index}}
                            </template>
                        </el-table-column>
                        <el-table-column prop="ProductName" :label="i18ns.server.name"></el-table-column>
                        <el-table-column prop="SerialNumber" :label="i18ns.server.sn"></el-table-column>
                        <el-table-column prop="" :label="i18ns.server.healthStatus">
                            <template slot-scope="scope">
                                {{getHealthStausTxt(scope.row.Health)}}
                            </template>
                        </el-table-column>
                        <el-table-column prop="" :label="i18ns.server.positionStatus">
                            <template slot-scope="scope">
                                {{getPositionStatusTxt(scope.row.State)}}
                            </template>
                        </el-table-column>
                        <el-table-column prop="" :label="i18ns.server.managerLink">
                            <template slot-scope="scope">
                                {{getActiveStandbyTxt(scope.row.State)}}
                            </template>
                        </el-table-column>
                        <el-table-column prop="" :label="i18ns.server.emIp" min-width="230">
                            <template slot-scope="scope">
                                <el-row>
                                    <el-col :span="14">{{i18ns.server.staticIp}}</el-col>
                                    <el-col :span="10">
                                        <el-row v-if="scope.row.StaticIPv4Address">
                                            {{scope.row.StaticIPv4Address.Address?scope.row.StaticIPv4Address.Address:'--'}}
                                        </el-row>
                                        <el-row v-else> -- </el-row>
                                    </el-col>
                                </el-row>
                                <el-row>
                                    <el-col :span="14">{{i18ns.server.floatIp}}</el-col>
                                    <el-col :span="10">
                                        <el-row v-if="scope.row.FloatIPv4Address">
                                            {{scope.row.FloatIPv4Address.Address?scope.row.FloatIPv4Address.Address:'--'}}
                                        </el-row>
                                        <el-row v-else> -- </el-row>
                                    </el-col>
                                </el-row>
                                <el-row>
                                    <el-col :span="14">{{i18ns.server.frameManagement_oneMoIP}}</el-col>
                                    <el-col :span="10">
                                        <el-row v-if="scope.row.ApplianceIPv4Address">
                                            {{scope.row.ApplianceIPv4Address.Address?scope.row.ApplianceIPv4Address.Address:'--'}}
                                        </el-row>
                                        <el-row v-else> -- </el-row>
                                    </el-col>
                                </el-row>
                            </template>
                        </el-table-column>
                        <el-table-column prop="" :label="i18ns.server.subnetMask">
                            <template slot-scope="scope">
                                <el-row>
                                    <el-row v-if="scope.row.StaticIPv4Address">
                                        {{scope.row.StaticIPv4Address.SubnetMask?scope.row.StaticIPv4Address.SubnetMask:'--'}}
                                    </el-row>
                                    <el-row v-else> -- </el-row>
                                </el-row>
                                <el-row>
                                    <el-row v-if="scope.row.FloatIPv4Address">
                                        {{scope.row.FloatIPv4Address.SubnetMask?scope.row.FloatIPv4Address.SubnetMask:'--'}}
                                    </el-row>
                                    <el-row v-else> -- </el-row>
                                </el-row>
                                <el-row>
                                    <el-row v-if="scope.row.ApplianceIPv4Address">
                                        {{scope.row.ApplianceIPv4Address.SubnetMask?scope.row.ApplianceIPv4Address.SubnetMask:'--'}}
                                    </el-row>
                                    <el-row v-else> -- </el-row>
                                </el-row>
                            </template>
                        </el-table-column>
                        <el-table-column prop="" :label="i18ns.server.gateway">
                            <template slot-scope="scope">
                                <el-row>
                                    <el-row v-if="scope.row.StaticIPv4Address">
                                        {{scope.row.StaticIPv4Address.Gateway?scope.row.StaticIPv4Address.Gateway:'--'}}
                                    </el-row>
                                    <el-row v-else> -- </el-row>
                                </el-row>
                                <el-row>
                                    <el-row v-if="scope.row.FloatIPv4Address">
                                        {{scope.row.FloatIPv4Address.Gateway?scope.row.FloatIPv4Address.Gateway:'--'}}
                                    </el-row>
                                    <el-row v-else> -- </el-row>
                                </el-row>
                                <el-row>
                                    <el-row v-if="scope.row.ApplianceIPv4Address">
                                        {{scope.row.ApplianceIPv4Address.Gateway?scope.row.ApplianceIPv4Address.Gateway:'--'}}
                                    </el-row>
                                    <el-row v-else> -- </el-row>
                                </el-row>
                            </template>
                        </el-table-column>

                    </el-table>
                </el-collapse-item>
                <!-- 服务器列表 -->
                <el-collapse-item :title="i18ns.server.server" name="server">
                    <el-table :data="serverList" border style="width:100%;"  :empty-text="emptyText"
                        :element-loading-text="i18ns.common.loading" header-row-class-name="my_table_header">
                        <el-table-column prop="Index" :label="i18ns.server.slotNumber">
                            <template slot-scope="scope">
                                {{'Slot'+scope.row.Index}}
                            </template>
                        </el-table-column>
                        <el-table-column prop="IPv4Address.Address" label="BMC IP">
                            <template slot-scope="scope">
                                <el-button type="text" size="small" @click="showServerInfo(scope.row)">
                                    {{scope.row.IPv4Address?scope.row.IPv4Address.Address:'--'}}</el-button>
                            </template>
                        </el-table-column>
                        <el-table-column prop="" :label="i18ns.server.healthStatus">
                            <template slot-scope="scope">
                                {{getChildSeverHealthStatusTxt(scope.row.Status?scope.row.Status.Health:'')}}
                            </template>
                        </el-table-column>
                        <el-table-column prop="" :label="i18ns.server.server_manageStatus">
                            <template slot-scope="scope">
                                {{getManageStatusTxt(scope.row.State)}}
                            </template>
                        </el-table-column>
                        <el-table-column prop="Model" :label="i18ns.server.model">
                            <template slot-scope="scope">{{scope.row.Model?scope.row.Model:'--'}}</template>
                        </el-table-column>
                        <!--  <el-table-column prop="Status.State" :label="i18ns.server.positionStatus">
                            <template  slot-scope="scope">
                                {{scope.row.Status?getPositionStatusTxt(scope.row.Status.State):getPositionStatusTxt('')}}
                            </template>
                        </el-table-column> -->
                        <el-table-column prop="SerialNumber" :label="i18ns.server.sn"></el-table-column>
                    </el-table>
                </el-collapse-item>
                <!-- 交换板列表 -->
                <el-collapse-item :title="i18ns.server.switchModule" name="switch">
                    <el-table :data="switchList" border style="width:100%;" :empty-text="emptyText"
                        :element-loading-text="i18ns.common.loading" header-row-class-name="my_table_header">
                        <el-table-column prop="Index" :label="i18ns.server.slotNumber">
                            <template slot-scope="scope">
                                <span v-if="scope.row.Index==1">1E</span>
                                <span v-else-if="scope.row.Index==2">2X</span>
                                <span v-else-if="scope.row.Index==3">3X</span>
                                <span v-else-if="scope.row.Index==4">4E</span>
                                <span v-else>{{scope.row.Index}}</span>
                            </template>
                        </el-table-column>
                        <el-table-column prop="ProductName" :label="i18ns.server.name">
                            <template slot-scope="scope">{{scope.row.ProductName?scope.row.ProductName:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="" :label="i18ns.server.healthStatus">
                            <template slot-scope="scope">
                                {{getSwitchTxt(scope.row.SwitchState,scope.row.Status?scope.row.Status.Health:'')}}
                            </template>
                        </el-table-column>
                        <el-table-column prop="Status.State" :label="i18ns.server.positionStatus">
                            <template slot-scope="scope">
                                {{scope.row.State?getPositionStatusTxt(scope.row.State):getPositionStatusTxt('')}}
                            </template>
                        </el-table-column>
                        <el-table-column prop="SerialNumber" :label="i18ns.server.sn">
                            <template
                                slot-scope="scope">{{scope.row.SerialNumber?scope.row.SerialNumber:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="IPv4Address.Address" label="BMC IP">
                            <template
                                slot-scope="scope">{{scope.row.IPv4Address?scope.row.IPv4Address.Address:'--'}}</template>
                        </el-table-column>

                    </el-table>
                </el-collapse-item>
                <!-- 电源列表 -->
                <el-collapse-item :title="i18ns.server.power" name="power">
                    <el-table :data="powerList" border style="width:100%;" v-loading="powerLoading"
                        :element-loading-text="i18ns.common.loading" header-row-class-name="my_table_header">
                        <el-table-column prop="Index" :label="i18ns.server.slotNumber">
                            <template slot-scope="scope">{{scope.row.Index?('PSU'+scope.row.Index):'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="Name" :label="i18ns.server.name">
                            <template slot-scope="scope">{{scope.row.Name?scope.row.Name:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="" :label="i18ns.server.healthStatus">
                            <template slot-scope="scope">
                                {{scope.row.Health?getHealthStausTxt(scope.row.Health):getHealthStausTxt('')}}
                            </template>
                        </el-table-column>
                        <el-table-column prop="" :label="i18ns.server.positionStatus">
                            <template slot-scope="scope">
                                {{scope.row.State?getPositionStatusTxt(scope.row.State):getPositionStatusTxt('')}}
                            </template>
                        </el-table-column>
                        <el-table-column prop="PowerCapacityWatts" :label="i18ns.server.ratedPower">
                            <template slot-scope="scope">
                                <el-row v-if="scope.row.PowerCapacityWatts">
                                    {{scope.row.PowerCapacityWatts+'W'}}
                                </el-row>
                            </template>
                        </el-table-column>
                        <el-table-column prop="PowerSupplyType" :label="i18ns.server.inputMode">
                            <template
                                slot-scope="scope">{{scope.row.PowerSupplyType?scope.row.PowerSupplyType:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="FirmwareVersion" :label="i18ns.server.firmwareVersion">
                            <template
                                slot-scope="scope">{{scope.row.FirmwareVersion?scope.row.FirmwareVersion:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="HardwareVersion" :label="i18ns.server.hardwareVersion">
                            <template
                                slot-scope="scope">{{scope.row.HardwareVersion?scope.row.HardwareVersion:'--'}}</template>
                        </el-table-column>
                    </el-table>
                </el-collapse-item>
                <!-- 风扇列表 -->
                <el-collapse-item :title="i18ns.server.fan" name="fan">
                    <el-table :data="fanList" border style="width:100%;" v-loading="fanLoading"
                        :element-loading-text="i18ns.common.loading" header-row-class-name="my_table_header">
                        <el-table-column prop="Index" :label="i18ns.server.slotNumber">
                            <template slot-scope="scope">{{scope.row.Index?('Fan'+scope.row.Index):'--'}}
                            </template>
                        </el-table-column>
                        <el-table-column prop="Name" :label="i18ns.server.name">
                            <template slot-scope="scope">{{scope.row.Name?scope.row.Name:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="" :label="i18ns.server.healthStatus">
                            <template slot-scope="scope">
                                {{scope.row.Health?getHealthStausTxt(scope.row.Health):getHealthStausTxt('')}}
                            </template>
                        </el-table-column>
                        <el-table-column prop="" :label="i18ns.server.positionStatus">
                            <template slot-scope="scope">
                                {{scope.row.State?getPositionStatusTxt(scope.row.State):getPositionStatusTxt('')}}
                            </template>
                        </el-table-column>
                    </el-table>
                </el-collapse-item>
            </el-collapse>
        </el-row>
        <el-row>
            <!-- 返回按钮 -->
            <el-button style="margin-top:10px;" @click="back">{{i18ns.common.back}}</el-button>
        </el-row>
    </div>
    <script>
        var app = new Vue({
            el: '#app',
            data: {
                i18ns: [],
                FDs: [],
                FDIp: '',
                deviceId: '',
                loading: false,
                powerLoading: false,
                fanLoading: false,
                managerLoading: false,
                switchLoading: false,
                serverLoading: false,
                fullscreenLoading: false,
                dialogVisible: false,
                dialogDeviceType: '1',
                dialogPowerOperation: '',
                multipleSelection: [],
                severInfo: {},
                activeNames: [],
                powerList: [],
                fanList: [],
                managerList: [],
                switchList: [],
                serverList: [],
                isShowView: false,
                serverHealthState: {
                    normal: 0,
                    warning: 0,
                    critical: 0,
                    unknown: 0
                },
                switchHealthState: {
                    normal: 0,
                    warning: 0,
                    critical: 0,
                    unknown: 0
                },
                managerHealthState: {
                    normal: 0,
                    warning: 0,
                    critical: 0,
                    unknown: 0
                },
                fanHealthState: {
                    normal: 0,
                    warning: 0,
                    critical: 0,
                    unknown: 0
                },
                powerHealthState: {
                    normal: 0,
                    warning: 0,
                    critical: 0,
                    unknown: 0
                },
                serverViews: [],
                frameLeftPowerList: [],
                frameRightPowerList: [],
                frameLeftFanList: [],
                frameRightFanList: [],
                frameTopFanList: [],
                frameManagementPanel1: [],
                frameManagementPanel2: [],
                switchPanelList: [],
                emptyText:''
            },
            computed: {

                stateAndStateReasonTxt: function () {
                    if (this.severInfo.State && this.severInfo.StateReason) {
                        return this.getStateInfoTxt(this.severInfo.State) + '/' + this.getStateReasonTxt(
                            this.severInfo.StateReason);
                    } else {
                        return '--';
                    }
                },

                dialogList: function () {
                    var arry = [];
                    for (var i = 0; i < this.serverList.length; i++) {
                        var item = this.serverList[i];
                        if (this.dialogPowerOperation == 'ForceOff') {
                            if (item.PowerState == 'On') {
                                arry.push(item);
                            }
                        }
                        if (this.dialogPowerOperation == 'On') {
                            if (item.PowerState == 'Off') {
                                arry.push(item);
                            }
                        }
                    }
                    return arry;

                },
                isShowFanChart: function () {
                    return (this.fanHealthState.normal + this.fanHealthState.warning + this.fanHealthState
                        .critical +
                        this.fanHealthState.unknown) > 0;
                },
                isShowPowerChart: function () {
                    return (this.powerHealthState.normal + this.powerHealthState.warning + this
                        .powerHealthState
                        .critical +
                        this.powerHealthState.unknown) > 0;
                },
                isShowManagerChart: function () {
                    return (this.managerHealthState.normal + this.managerHealthState.warning + this
                        .managerHealthState
                        .critical +
                        this.managerHealthState.unknown) > 0;
                },
                isShowSwitchChart: function () {
                    return (this.switchHealthState.normal + this.switchHealthState.warning + this
                        .switchHealthState
                        .critical +
                        this.switchHealthState.unknown) > 0;
                },
                isShowServerChart: function () {
                    return (this.serverHealthState.normal + this.serverHealthState.warning + this
                        .serverHealthState
                        .critical +
                        this.serverHealthState.unknown) > 0;
                }
            },
            created: function () {
                this.i18ns = getIn18();
                this.FDIp = getCurrentFD();
                this.deviceId = getQueryString('id');
            },
            mounted: function () {
                Vue.nextTick(function () {
                    app.getEnclosureBasicInfo();
                })
            },
            methods: {

                /**
                 *  返回按钮方法 
                 * **/
                back: function () {
                    window.location.href = '../server/list.html?s=' + Math.random()
                },
                /**
                 *获取服务器上下电状态
                 **/
                getPowerState: function (status) {
                    if (status) {
                        status = status.toLowerCase();
                        return status == 'on' ? this.i18ns.server.server_electricityOn : this.i18ns.server
                            .server_electricityOff
                    } else {
                        return this.i18ns.server.unknown;
                    }
                },
                /**
                 * 获取设备健康状态
                 **/
                getHealthStausTxt: function (status) {
                    return getHealthStatusTxt(status);
                },
                /**
                 * 子服务器健康状态
                 * @param {*} status 
                 */
                getChildSeverHealthStatusTxt: function (healthStatus) {
                    /*  var lang = localStorage.getItem('lang');
                     if (!status || !status.health) {
                         return lang == 'zhCN' ? "未知" : "Unknown";
                     }
                     status = status.health.toLowerCase();
                     if (status == "ok") {
                         return lang == 'zhCN' ? "正常" : "health";
                     } else if (status == "warning") {
                         return lang == 'zhCN' ? "警告" : "Warning";
                     } else if (status == "critical") {
                         return lang == 'zhCN' ? "紧急" : "Critical";
                     } else {
                         return lang == 'zhCN' ? "未知" : "Unknown";
                     } */
                    return getServerStatusTxt(healthStatus);
                },

                /**
                 * 获取服务器管理状态
                 **/
                getManageStatusTxt: function (serverStatus) {
                    return getManageStatusTxt(serverStatus);
                },

                /**
                 * 设备在位状态
                 **/
                getPositionStatusTxt: function (status) {
                    return getPositionStatusTxt(status);
                },

                /**
                 * 管理板主备关系
                 **/
                getActiveStandbyTxt: function (status) {
                    return getActiveStandbyTxt(status);
                },

                /**
                 * 交换板状态
                 **/
                getSwitchTxt: function (switchState, healthStatus) {
                    return getSwitchTxt(switchState, healthStatus);
                },

                /**
                 * 获取服务器基本信息
                 */
                getEnclosureBasicInfo: function () {
                    var param = {
                        ip: this.FDIp,
                        deviceId: this.deviceId
                    }
                    serverManage.getEnclosureBasicInfo(param, function (ret) {
                        if (ret.code === '0') {
                            var enclosureData = ret.data[0].data;
                            app.severInfo = ret.data[0].data;
                            app.managerList = ret.data[0].data.Slot.ManagerSlot;
                            app.powerList = ret.data[0].data.Slot.PowerSlot;
                            app.fanList = ret.data[0].data.Slot.FanSlot;
                            /*   app.drawManager();
                              app.drawPower();
                              app.drawFan(); */
                            app.getSwitchList();
                            app.getServerList();
                            /*后视图*/
                            //电源
                            app.frameLeftPowerList = [];
                            app.frameRightPowerList = [];
                            app.frameLeftPowerList.push(_.filter(enclosureData.Slot.PowerSlot, {
                                Index: 3
                            }));
                            app.frameLeftPowerList.push(_.filter(enclosureData.Slot.PowerSlot, {
                                Index: 2
                            }));
                            app.frameLeftPowerList.push(_.filter(enclosureData.Slot.PowerSlot, {
                                Index: 1
                            }));
                            app.frameLeftPowerList = _.flatten(app.frameLeftPowerList);
                            app.frameRightPowerList.push(_.filter(enclosureData.Slot.PowerSlot, {
                                Index: 6
                            }));
                            app.frameRightPowerList.push(_.filter(enclosureData.Slot.PowerSlot, {
                                Index: 5
                            }));
                            app.frameRightPowerList.push(_.filter(enclosureData.Slot.PowerSlot, {
                                Index: 4
                            }));
                            app.frameRightPowerList = _.flatten(app.frameRightPowerList);
                            //风扇
                            app.frameLeftFanList = [];
                            app.frameLeftFanList.push(_.filter(enclosureData.Slot.FanSlot, {
                                Index: 6
                            }));
                            app.frameLeftFanList.push(_.filter(enclosureData.Slot.FanSlot, {
                                Index: 5
                            }));
                            app.frameLeftFanList.push(_.filter(enclosureData.Slot.FanSlot, {
                                Index: 4
                            }));
                            app.frameLeftFanList.push(_.filter(enclosureData.Slot.FanSlot, {
                                Index: 3
                            }));
                            app.frameLeftFanList.push(_.filter(enclosureData.Slot.FanSlot, {
                                Index: 2
                            }));
                            app.frameLeftFanList.push(_.filter(enclosureData.Slot.FanSlot, {
                                Index: 1
                            }));
                            app.frameLeftFanList = _.flatten(app.frameLeftFanList);
                            app.frameRightFanList = [];
                            app.frameRightFanList.push(_.filter(enclosureData.Slot.FanSlot, {
                                Index: 12
                            }));
                            app.frameRightFanList.push(_.filter(enclosureData.Slot.FanSlot, {
                                Index: 11
                            }));
                            app.frameRightFanList.push(_.filter(enclosureData.Slot.FanSlot, {
                                Index: 10
                            }));
                            app.frameRightFanList.push(_.filter(enclosureData.Slot.FanSlot, {
                                Index: 9
                            }));
                            app.frameRightFanList.push(_.filter(enclosureData.Slot.FanSlot, {
                                Index: 8
                            }));
                            app.frameRightFanList.push(_.filter(enclosureData.Slot.FanSlot, {
                                Index: 7
                            }));
                            app.frameRightFanList = _.flatten(app.frameRightFanList);
                            app.frameTopFanList = [];
                            app.frameTopFanList.push(_.filter(enclosureData.Slot.FanSlot, {
                                Index: 13
                            }));
                            app.frameTopFanList.push(_.filter(enclosureData.Slot.FanSlot, {
                                Index: 14
                            }));
                            app.frameTopFanList = _.flatten(app.frameTopFanList);
                            //管理板
                            app.frameManagementPanel1 = _.filter(enclosureData.Slot.ManagerSlot, {
                                Index: 1
                            });
                            app.frameManagementPanel2 = _.filter(enclosureData.Slot.ManagerSlot, {
                                Index: 2
                            });
                            app.isShowView = true;
                        } else {
                            if (ret.ip != app.FDIp) {
                                return false
                            }
                            var msg = getErrorMsg(ret);
                            alertMsg(msg);
                        }
                    })
                },

                /**
                 * 获取交换板
                 */
                getSwitchList: function () {
                    var switchList = _.filter(app.severInfo.Slot.SwitchSlot, function (item) {
                        return item.State == 'Enabled';
                    });
                    var k = switchList.length;
                    for (var i = 0; i < switchList.length; i++) {
                        (function (arg) {
                            var str = arg.ResourceURL;
                            if (str) {
                                var deviceId = str.substr(str.lastIndexOf('/') + 1)
                                if (!deviceId) {
                                    app.switchList.push(arg);
                                    k--;
                                } else {
                                    app.emptyText = app.i18ns.common.loading;
                                    serverManage.getOneSwitch({
                                        ip: app.FDIp,
                                        deviceId: deviceId
                                    }, function (ret) {
                                        k--;
                                        app.emptyText = app.i18ns.common.noData;
                                        if (ret.code == '0') {
                                            var item = _.assign(ret.data[0].data, {
                                                Index: arg.Index,
                                                ProductName: arg.ProductName,
                                                State: arg.State
                                            });
                                            app.switchList.push(item);
                                        } else {
                                            app.switchList.push(arg);
                                            /*  var msg = getErrorMsg(ret);
                                             alertMsg(msg); */
                                        }
                                    })
                                }
                            } else {
                                app.switchList.push(arg);
                                k--;
                            }
                        })(switchList[i])
                    }
                    var mysetInterval = setInterval(function () {
                        if (k == 0) {
                            app.emptyText = app.i18ns.common.noData;
                            /* app.drawSwitch(); */
                            app.getSwitchPanelList(app.switchList);
                            window.clearInterval(mysetInterval);
                        }
                    }, 100)

                },

                getSwitchPanelList: function (switchList) {
                    for (var i = 0; i < app.severInfo.Slot.SwitchSlot.length; i++) {
                        var switchInfo = app.severInfo.Slot.SwitchSlot[i];
                        var tempSwitchObj = {
                            Index: "",
                            ProductName: "",
                            State: "",
                            SerialNumber: "",
                            Health: "",
                            SwitchState: "",
                            BMCIP: "",
                            flexName1: "",
                            flexSerialNumber1: "",
                            flexName2: "",
                            flexSerialNumber2: ""
                        };
                        tempSwitchObj.Index = switchInfo.Index;
                        tempSwitchObj.ProductName = switchInfo.ProductName;
                        tempSwitchObj.State = switchInfo.State;
                        tempSwitchObj.SerialNumber = switchInfo.SerialNumber;
                        app.switchPanelList.push(tempSwitchObj);
                        if (switchInfo.State == 'Enabled') {
                            var item = _.find(switchList, function (x) {
                                return x.Index == switchInfo.Index;
                            })
                            console.log(item, i);
                            if (item) {
                                app.switchPanelList[i].Health = item.Status ? item.Status.Health : '';
                                app.switchPanelList[i].BMCIP = item.IPv4Address ? item.IPv4Address.Address :
                                    '';
                                app.switchPanelList[i].SwitchState = item.SwitchState;
                                if (item.Board && item.Board['@odata.id']) {
                                    (function (arg) {
                                        if (item.deviceId) {
                                            serverManage.getOneSwitchBoards({
                                                ip: app.FDIp,
                                                deviceId: item.deviceId
                                            }, function (ret) {
                                                if (ret.code == '0') {
                                                    var boardEle = ret.data[0].data;
                                                    var index = _.findIndex(app.switchPanelList,
                                                        function (
                                                            x) {
                                                            return x.Index == item.Index;
                                                        });
                                                    if (index > -1) {
                                                        if (boardEle.DeviceType === "PICCard") {
                                                            var deviceLocator = boardEle
                                                                .DeviceLocator;
                                                            if (deviceLocator === 'PICCard1') {
                                                                app.switchPanelList[index]
                                                                    .flexName1 =
                                                                    getCard(boardEle.BoardName);
                                                                app.switchPanelList[index]
                                                                    .flexSerialNumber1 =
                                                                    boardEle.SerialNumber;
                                                            }
                                                            if (deviceLocator === 'PICCard2') {
                                                                app.switchPanelList[index]
                                                                    .flexName2 =
                                                                    getCard(boardEle.BoardName);
                                                                app.switchPanelList[index]
                                                                    .flexSerialNumber2 =
                                                                    boardEle.SerialNumber;
                                                            }
                                                        }
                                                    }

                                                }
                                            })
                                        }
                                    })(item)
                                }

                            }
                        }

                    }
                },

                /**
                 * 获取服务器
                 */
                getServerList: function () {
                    var serverList = _.filter(app.severInfo.Slot.ServerSlot, function (item) {
                        return item.State == 'Enabled';
                    });
                    var k = serverList.length;
                    for (var i = 0; i < serverList.length; i++) {
                        if (serverList[i].ResourceURL) {

                            (function (arg) {
                                var str = arg.ResourceURL;
                                var deviceId = str.substr(str.lastIndexOf('/') + 1)
                                if (!deviceId) {
                                    app.serverList.push(arg);
                                    k--;
                                } else {
                                    app.emptyText = app.i18ns.common.loading;
                                    serverManage.getBasicInfo({
                                        ip: app.FDIp,
                                        deviceId: deviceId
                                    }, function (ret) {
                                        app.emptyText = app.i18ns.common.noData;
                                        k--;
                                        if (ret.code == '0') {
                                            var item = _.assign(ret.data[0].data, {
                                                Index: arg.Index
                                            });
                                            app.serverList.push(item);
                                        } else {
                                            app.serverList.push(arg);
                                            /*   var msg = getErrorMsg(ret);
                                              alertMsg(msg); */
                                        }
                                    })
                                }
                            })(serverList[i])
                        } else {
                            k--;
                            app.serverList.push(serverList[i]);
                        }
                    }
                    var mysetInterval = setInterval(function () {
                        if (k == 0) {
                            app.emptyText = app.i18ns.common.noData;
                            /*  app.drawServer(); */
                            app.getServerView();
                            window.clearInterval(mysetInterval);
                        }
                    }, 100)

                },

                getServerView: function () {
                    var arry = [];
                    for (var i = 0; i < 16; i++) {
                        var item = {
                            "slot": app.severInfo.Slot.ServerSlot[i].Index,
                            "slotState": app.severInfo.Slot.ServerSlot[i].State,
                            "productName": app.severInfo.Slot.ServerSlot[i].ProductName,
                            "resourceURL": app.severInfo.Slot.ServerSlot[i].ResourceURL,
                            "name": "",
                            "serialNumber": app.severInfo.Slot.ServerSlot[i].SerialNumber,
                            "BMCIP": "",
                            "health": "",
                            "serverState": "",
                            "width": app.severInfo.Slot.ServerSlot[i].Width ? app.severInfo.Slot
                                .ServerSlot[
                                    i].Width : 1,
                            "height": app.severInfo.Slot.ServerSlot[i].Height ? app.severInfo.Slot
                                .ServerSlot[
                                    i].Height : 2,
                            "powerState": ""
                        }
                        if (item.resourceURL) {
                            var resourceURL = item.resourceURL;
                            var _id = resourceURL.substr(resourceURL.lastIndexOf('/') + 1);
                            var serverInfo = _.find(app.serverList, function (x) {
                                var odataId = x["@odata.id"];
                                if (odataId) {
                                    var id = odataId.substr(odataId.lastIndexOf('/') + 1);
                                    return id == _id;
                                }
                            });
                            if (serverInfo) {
                                item.name = serverInfo.Name;
                                item.BMCIP = serverInfo.IPv4Address.Address;
                                item.health = serverInfo.Status.Health;
                                item.serverState = serverInfo.ServerState;
                                item.powerState = serverInfo.PowerState;
                            }
                        }
                        arry.push(item);
                    }
                    for (var i = 0; i < 8; i++) {
                        var item1 = arry[7 - i];
                        var item2 = arry[15 - i];
                        var left = {};
                        var right = {};
                        if (item1.width == 2) {
                            left = item1;
                        } else {
                            if (item2.width == 2) {
                                left = item2;
                            } else {
                                left = item1;
                                right = item2;
                            }
                        }
                        var item = {
                            slotIndex: 8 - i,
                            left: left,
                            right: right
                        }
                        app.serverViews.push(item);
                    }
                },

                /**
                 * 服务器饼状图
                 */
                drawServer: function () {
                    for (var i = 0; i < app.serverList.length; i++) {
                        var status = app.serverList[i].Status;
                        if (status && status.health) {
                            if (status.health.toLowerCase() == 'ok') {
                                app.serverHealthState.normal += 1;
                            } else if (status.health.toLowerCase() ==
                                'warning') {
                                app.serverHealthState.warning += 1;
                            } else if (status.health.toLowerCase() ==
                                'critical') {
                                app.serverHealthState.critical += 1;
                            } else {
                                app.serverHealthState.unknown += 1;
                            }
                        } else {
                            app.serverHealthState.unknown += 1;
                        }
                    }
                    app.draw('server', app.serverHealthState);
                },

                /**
                 * 查看服务器明细信息
                 * 
                 * @param {any} row 
                 */
                showServerInfo: function (row) {
                    window.location.href = '../server/enclosureServerInfo.html?id=' + row.DeviceID;
                },

                handleSelectionChange: function (val) {
                    this.multipleSelection = val;
                    console.log(val);
                },

                resetServer: function () {
                    var param = {
                        ip: this.FDIp,
                        data: {
                            "ResetType": this.dialogPowerOperation,
                            "DeviceIDs": _.map(this.multipleSelection, 'DeviceID')
                        }
                    }
                    serverManage.computerReset(param, function (ret) {
                        if (ret.code === '0') {
                            app.dialogVisible = false;
                            var tips = app.dialogPowerOperation == 'On' ? app.i18ns.server
                                .frameManagement_serverUpPowerTask :
                                app.i18ns.server.frameManagement_serverDownPowerTask;
                            app.$alert(tips, app.i18ns.prompt, {
                                confirmButtonText: app.i18ns.confirm,
                            });
                            var headers = ret.headers;
                            if (headers && headers.task) {
                                var task = headers.task[0];
                                var taskId = task.substr(task.lastIndexOf('/') + 1)
                                var mysetInterval = setInterval(function () {
                                    serverManage.tasks({
                                        ip: app.FDIp,
                                        taskId: taskId
                                    }, function (res) {
                                        if (res.code == 0) {
                                            if (res.data[0].data.Status ==
                                                'Finish') {
                                                window.clearInterval(
                                                    mysetInterval);
                                                var successTips = app
                                                    .dialogPowerOperation ==
                                                    'On' ? app.i18ns.server
                                                    .server_powerOnSuccessTip :
                                                    app.i18ns.server
                                                    .server_powerOffSuccessTip;
                                                app.$message({
                                                    message: successTips,
                                                    type: 'success',
                                                    callback: function () {
                                                        window.location
                                                            .reload();
                                                    }
                                                });
                                            }
                                            if (res.data[0].data.Status ==
                                                'Failed') {
                                                window.clearInterval(
                                                    mysetInterval);
                                                var errorTips = app
                                                    .dialogPowerOperation ==
                                                    'On' ? app.i18ns.server
                                                    .server_powerOnFailTip :
                                                    app.i18ns.server
                                                    .server_powerOffFailTip;
                                                app.$message({
                                                    message: errorTips,
                                                    type: 'success'
                                                });
                                            }

                                        }
                                    });
                                }, 1000);
                            }
                        } else {
                            if (ret.ip != app.FDIp) {
                                return false
                            }
                            msg = getErrorMsg(ret);
                            alertMsg(msg);
                        }
                    })
                },

                //获取状态机框原因
                getStateReasonTxt: function (stateReason) {
                    switch (stateReason) {
                        case "AutoChange":
                            return this.i18ns.server.frameManagement_autoChange;
                            break;
                        case "ManualRefresh":
                            return this.i18ns.server.frameManagement_manualRefresh;
                            break;
                        case "Refresh":
                            return this.i18ns.server.frameManagement_refreshFrame;
                            break;
                        case "Upgrade":
                            return this.i18ns.server.frameManagement_upgrade;
                            break;
                        case "UpgradeComponent":
                            return this.i18ns.server.frameManagement_upgradeComponent;
                            break;
                        case "Remove":
                            return this.i18ns.server.frameManagement_remove;
                            break;
                        case "LoginFailure":
                            return this.i18ns.server.frameManagement_loginFailure;
                            break;
                        case "ConnectionLost":
                            return this.i18ns.server.frameManagement_connectionLost;
                            break;
                        case "PropertyUnknown":
                            return this.i18ns.server.frameManagement_propertyUnknown;
                            break;
                        case "Apply":
                            return this.i18ns.server.frameManagement_apply;
                            break;
                        case "RebootManger":
                            return this.i18ns.server.frameManagement_rebootManger;
                            break;

                        case "SwitchMasterManager":
                            return this.i18ns.server.frameManagement_switchMasterManager;
                            break;
                        case "DumpManagerLog":
                            return this.i18ns.server.frameManagement_dumpManagerLog;
                            break;
                        default:
                            return this.i18ns.server.frameManagement_autoChange;
                    }
                },

                //获取机框状态
                getStateInfoTxt: function (state) {
                    switch (state) {
                        case "Added":
                            return this.i18ns.server.frameManagement_added;
                            break;
                        case "Ready":
                            return this.i18ns.server.frameManagement_ready;
                            break;
                        case "Locked":
                            return this.i18ns.server.frameManagement_locked;
                            break;
                        case "Unmanaged":
                            return this.i18ns.server.frameManagement_unManaged;
                            break;
                        default:
                            return this.i18ns.server.frameManagement_unManaged;
                    }
                }

            }
        });
    </script>
</body>

</html>