<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>服务器信息</title>
    <link href="../../css/element.css" rel="stylesheet" />
    <link href="../../css/style.css" rel="stylesheet" />
    <script src="../../scripts/vue.js"></script>
    <script src="../../scripts/element.js"></script>
    <script src="../../scripts/jquery-3.2.1.min.js"></script>
    <script src="../../scripts/i18n/zh-CN.js"></script>
    <script src="../../scripts/i18n/en.js"></script>
    <script src="../i18n/en.js"></script>
    <script src="../i18n/zh-CN.js"></script>
    <script src="../../scripts/polyfill.min.js"></script>
    <script src="../js/common.js"></script>
    <script src="../../scripts/web-platform.js"></script>
    <script src="../js/errorCode.js"></script>
    <script src="../../scripts/lodash.min.js"></script>
    <script src="../../scripts/Chart.bundle.min.js"></script>
    <script src="js/rest.js"></script>
    <style>
        [v-cloak] {
            display: none;
        }

        body {
            min-width: 900px;
        }

        .basicSeverinfo {
            border-collapse: collapse;
        }

        .basicSeverinfo tr td {
            border: 1px solid #dfe6ec;
            height: 30px;
            min-width: 150px;
            padding-left: 5px;
        }

        .basicSeverinfo tr td:nth-child(1),
        .basicSeverinfo tr td:nth-child(3) {
            background-color: #eef1f6;
            width: 150px;
        }

        .el-collapse {
            border: 1px solid #dfe6ec;
        }

        .el-collapse-item__header {
            padding-left: 5px;
        }

        .el-collapse-item__arrow {
            margin-right: 8px;
            float: left;
            font-weight: 400;
        }

        .pieChart {
            margin-top: 10px;
            max-width: 300px;
            min-width: 260px;
        }

        .pieChart .pieChart-content {
            display: flex;
            align-items: center;
            margin-top: 12px;
            margin-left: 30px;
        }

        .pieChart .pieChart-content span:nth-child(1) {
            line-height: 10px;
            padding-left: 3px;
        }

        .pieChart .pieChart-content span:nth-child(2) {
            line-height: 10px;
            padding-left: 10px;
            padding-right: 5px;
        }

        .pieChart div:nth-child(2) {
            margin-top: 10px;
        }

        .pieChart .pieChart-title {
            line-height: 10px;
            padding-left: 10px;
            padding-bottom: 20px;
            padding-top: 5px;
            font-size: 14px;
            position: relative;
            top: -65px;
            text-align: center;
            height: 30px;
        }

        .pieChart .pieChart-title1 {
            line-height: 10px;
            padding-left: 23px;
            padding-bottom: 20px;
            padding-top: 5px;
            font-size: 14px;
            position: relative;
            top: -75px;
            text-align: center;
            height: 30px;
        }

        .pieChart .pieChart-chart {
            height: 120px;
            width: 120px;
            margin-top: 15px;
            float: right;
        }


        .pieChart .pieChart-error {
            margin-top: 60px;
            text-align: center;
        }

        .normalClass {
            width: 10px;
            height: 10px;
            background-color: white;
            border: 2px #32CD32 solid;
            -webkit-border-radius: 8px;
            border-radius: 8px;
        }

        .warningClass {
            width: 10px;
            height: 10px;
            background-color: white;
            border: 2px #FFBB33 solid;
            -webkit-border-radius: 8px;
            border-radius: 8px;
        }

        .criticalClass {
            width: 10px;
            height: 10px;
            background-color: white;
            border: 2px #FF0000 solid;
            -webkit-border-radius: 8px;
            border-radius: 8px;
        }

        .unknownClass {
            width: 10px;
            height: 10px;
            background-color: white;
            border: 2px #4169E1 solid;
            -webkit-border-radius: 8px;
            border-radius: 8px;
        }

        .power-btn {
            position: relative;
            z-index: 2;
            top: 0;
            left: 0;
            float: right;
        }
    </style>
</head>

<body>
    <div id="app" v-cloak>
        <div class="power-btn">
            <el-button type="danger" @click="dialogVisible = true" v-show="severInfo.PowerState=='On'">
                {{i18ns.server.server_powerOff}}</el-button>
            <el-button type="danger" @click="dialogVisible = true" v-show="severInfo.PowerState=='Off'">
                {{i18ns.server.server_powerOn}}</el-button>
        </div>
        <el-dialog :close-on-click-modal="false" :title="i18ns.common.prompt" :visible.sync="dialogVisible" width="80%">
            <el-row>
                <h3>{{severInfo.PowerState=='On'?i18ns.server.server_powerOffTip:i18ns.server.server_powerOnTip}}</h3>
            </el-row>
            <el-row>
                <el-table :data="[severInfo]" border style="width:100%;" header-row-class-name="my_table_header">
                    <el-table-column prop="SerialNumber" :label="i18ns.server.sn" min-width="140">
                        <template slot-scope="scope">{{scope.row.SerialNumber?scope.row.SerialNumber:'--'}}</template>
                    </el-table-column>
                    <el-table-column prop="" :label="i18ns.server.name">
                        <template slot-scope="scope">{{scope.row.Name?scope.row.Name:'--'}}</template>
                    </el-table-column>
                    <el-table-column prop="Model" :label="i18ns.server.model">
                        <template slot-scope="scope">{{scope.row.Model?scope.row.Model:'--'}}</template>
                    </el-table-column>
                    <el-table-column prop="" :label="i18ns.server.healthStatus">
                        <template slot-scope="scope">
                            {{getServerStatusTxt(severInfo.Status?severInfo.Status.Health:'')}}
                        </template>
                    </el-table-column>
                    <el-table-column prop="" :label="i18ns.server.BMCIP">
                        <template
                            slot-scope="scope">{{severInfo.IPv4Address?severInfo.IPv4Address.Address:'--'}}</template>
                    </el-table-column>
                </el-table>
            </el-row>
            <span slot="footer" class="dialog-footer">
                <el-button @click="dialogVisible = false">{{i18ns.common.no}}</el-button>
                <el-button type="primary" @click="reset(severInfo.PowerState)">{{i18ns.common.yes}}</el-button>
            </span>
        </el-dialog>
        <el-row v-loading.fullscreen.lock="fullscreenLoading " :element-loading-text="i18ns.common.loading">
            <table class="basicSeverinfo">
                <tr>
                    <td>{{i18ns.server.deviceModel}}</td>
                    <td>{{severInfo.Model}}</td>
                    <td>{{i18ns.server.status}}</td>
                    <td>
                        {{getServerStatusTxt(severInfo.Status?severInfo.Status.Health:'')}}
                    </td>
                </tr>
                <tr>
                    <td>{{i18ns.server.BMCIP}}</td>
                    <td>{{severInfo.IPv4Address?severInfo.IPv4Address.Address:'--'}}</td>
                    <td>{{i18ns.server.server_powerStatus}}</td>
                    <td>
                        {{severInfo.PowerState=='On'?i18ns.server.server_electricityOn:i18ns.server.server_electricityOff}}
                    </td>
                </tr>
                <tr>
                    <td>{{i18ns.server.UUID}}</td>
                    <td>{{severInfo.UUID?severInfo.UUID:'--'}}</td>
                    <td>{{i18ns.server.assetTag}}</td>
                    <td>{{severInfo.AssetTag?severInfo.AssetTag:'--'}}</td>
                </tr>
                <tr>
                    <td>{{i18ns.server.serialNumber}}</td>
                    <td>{{severInfo.SerialNumber?severInfo.SerialNumber:'--'}}</td>
                    <td>{{i18ns.server.manufacturer}}</td>
                    <td>{{severInfo.Manufacturer?severInfo.Manufacturer:'--'}}</td>
                </tr>
            </table>
        </el-row>
        <el-row>
            <div style="display:flex; flex-wrap: wrap;">
                <el-row class="pieChart">
                    <!--CPU饼状图-->
                    <el-col :span="12">
                        <div class="pieChart-chart" v-show="isShowCPUChart">
                            <canvas id="cpu" width="120" height="120"></canvas>
                        </div>
                        <div class="pieChart-chart" v-show="!isShowCPUChart">
                            <canvas id="cpu_noRecords" width="134" height="134"></canvas>
                        </div>
                        <div v-show="isShowCPUChart" class="pieChart-title">{{i18ns.server.cpu}}
                        </div>
                    </el-col>
                    <el-col :span="12">
                        <div class="pieChart-content">
                            <div class="normalClass"></div>
                            <span>{{cpuHealthState.normal}}</span>
                            <span>{{i18ns.server.normal}}</span>
                        </div>
                        <div class="pieChart-content">
                            <div class="warningClass"></div>
                            <span>{{cpuHealthState.warning}}</span>
                            <span>{{i18ns.server.warning}}</span>
                        </div>
                        <div class="pieChart-content">
                            <div class="criticalClass"></div>
                            <span>{{cpuHealthState.critical}}</span>
                            <span>{{i18ns.server.critical}}</span>
                        </div>
                        <div class="pieChart-content">
                            <div class="unknownClass"></div>
                            <span>{{cpuHealthState.unknown}}</span>
                            <span>{{i18ns.server.unknown}}</span>
                        </div>
                    </el-col>
                </el-row>
                <el-row class="pieChart">
                    <!--内存饼状图-->
                    <el-col :span="12">
                        <div class="pieChart-chart" v-show="isShowMemoryChart">
                            <canvas id="memory" width="120" height="120"></canvas>
                        </div>
                        <div class="pieChart-chart" v-show="!isShowMemoryChart">
                            <canvas id="memory_noRecords" width="134" height="134"></canvas>
                        </div>
                        <div v-show="isShowMemoryChart" class="pieChart-title">{{i18ns.server.memory}}</div>
                    </el-col>
                    <el-col :span="12">
                        <div class="pieChart-content">
                            <div class="normalClass"></div>
                            <span>{{memoryHealthState.normal}}</span>
                            <span>{{i18ns.server.normal}}</span>
                        </div>
                        <div class="pieChart-content">
                            <div class="warningClass"></div>
                            <span>{{memoryHealthState.warning}}</span>
                            <span>{{i18ns.server.warning}}</span>
                        </div>
                        <div class="pieChart-content">
                            <div class="criticalClass"></div>
                            <span>{{memoryHealthState.critical}}</span>
                            <span>{{i18ns.server.critical}}</span>
                        </div>
                        <div class="pieChart-content">
                            <div class="unknownClass"></div>
                            <span>{{memoryHealthState.unknown}}</span>
                            <span>{{i18ns.server.unknown}}</span>
                        </div>
                    </el-col>
                </el-row>
                <el-row class="pieChart">
                    <!--硬盘饼状图-->
                    <el-col :span="12">
                        <div class="pieChart-chart" v-show="isShowDriveChart">
                            <canvas id="drive" width="120" height="120"></canvas>
                        </div>
                        <div class="pieChart-chart" v-show="!isShowDriveChart">
                            <canvas id="drive_noRecords" width="134" height="134"></canvas>
                        </div>
                        <div v-show="isShowDriveChart" class="pieChart-title">{{i18ns.server.disk}}
                        </div>
                    </el-col>
                    <el-col :span="12">
                        <div class="pieChart-content">
                            <div class="normalClass"></div>
                            <span>{{driveHealthState.normal}}</span>
                            <span>{{i18ns.server.normal}}</span>
                        </div>
                        <div class="pieChart-content">
                            <div class="warningClass"></div>
                            <span>{{driveHealthState.warning}}</span>
                            <span>{{i18ns.server.warning}}</span>
                        </div>
                        <div class="pieChart-content">
                            <div class="criticalClass"></div>
                            <span>{{driveHealthState.critical}}</span>
                            <span>{{i18ns.server.critical}}</span>
                        </div>
                        <div class="pieChart-content">
                            <div class="unknownClass"></div>
                            <span>{{driveHealthState.unknown}}</span>
                            <span>{{i18ns.server.unknown}}</span>
                        </div>
                    </el-col>
                </el-row>
                <el-row class="pieChart" v-show="isShowFan">
                    <!--风扇饼状图-->
                    <el-col :span="12">
                        <div class="pieChart-chart" v-show="isShowFanChart">
                            <canvas id="fan" width="120" height="120"></canvas>
                        </div>
                        <div class="pieChart-chart" v-show="!isShowFanChart">
                            <canvas id="fan_noRecords" width="134" height="134"></canvas>
                        </div>
                        <div class="pieChart-title" v-show="isShowFanChart">{{i18ns.server.fan}}
                        </div>
                    </el-col>
                    <el-col :span="12">
                        <div class="pieChart-content">
                            <div class="normalClass"></div>
                            <span>{{fanHealthState.normal}}</span>
                            <span>{{i18ns.server.normal}}</span>
                        </div>
                        <div class="pieChart-content">
                            <div class="warningClass"></div>
                            <span>{{fanHealthState.warning}}</span>
                            <span>{{i18ns.server.warning}}</span>
                        </div>
                        <div class="pieChart-content">
                            <div class="criticalClass"></div>
                            <span>{{fanHealthState.critical}}</span>
                            <span>{{i18ns.server.critical}}</span>
                        </div>
                        <div class="pieChart-content">
                            <div class="unknownClass"></div>
                            <span>{{fanHealthState.unknown}}</span>
                            <span>{{i18ns.server.unknown}}</span>
                        </div>
                    </el-col>
                </el-row>
                <el-row class="pieChart" v-show="isShowPower">
                    <!--电源饼状图-->
                    <el-col :span="12">
                        <div class="pieChart-chart" v-show="isShowPowerChart">
                            <canvas id="power" width="120" height="120"></canvas>
                        </div>
                        <div class="pieChart-chart" v-show="!isShowPowerChart">
                            <canvas id="power_noRecords" width="134" height="134"></canvas>
                        </div>
                        <div class="pieChart-title" v-show="isShowPowerChart">{{i18ns.server.power}}
                        </div>
                    </el-col>
                    <el-col :span="12">
                        <div class="pieChart-content">
                            <div class="normalClass"></div>
                            <span>{{powerHealthState.normal}}</span>
                            <span>{{i18ns.server.normal}}</span>
                        </div>
                        <div class="pieChart-content">
                            <div class="warningClass"></div>
                            <span>{{powerHealthState.warning}}</span>
                            <span>{{i18ns.server.warning}}</span>
                        </div>
                        <div class="pieChart-content">
                            <div class="criticalClass"></div>
                            <span>{{powerHealthState.critical}}</span>
                            <span>{{i18ns.server.critical}}</span>
                        </div>
                        <div class="pieChart-content">
                            <div class="unknownClass"></div>
                            <span>{{powerHealthState.unknown}}</span>
                            <span>{{i18ns.server.unknown}}</span>
                        </div>
                    </el-col>
                </el-row>

            </div>
        </el-row>
        <el-row style="margin-top:8px;">
            <el-collapse v-model="activeNames">
                <!-- CPU -->
                <el-collapse-item :title="i18ns.server.cpu" name="cpu">
                    <el-table :data="cpuList" border style="width:100%;" v-loading="cpuLoading"
                        :element-loading-text="i18ns.common.loading" header-row-class-name="my_table_header">
                        <el-table-column prop="Name" :label="i18ns.server.name">
                            <template slot-scope="scope">{{scope.row.Name?scope.row.Name:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="" :label="i18ns.server.healthStatus">
                            <template slot-scope="scope">
                                {{scope.row.Status?getHealthStausTxt(scope.row.Status.Health):getHealthStausTxt('')}}
                            </template>
                        </el-table-column>
                        <el-table-column prop="Status.State" :label="i18ns.server.positionStatus">
                            <template slot-scope="scope">
                                {{scope.row.Status?getPositionStatusTxt(scope.row.Status.State):getPositionStatusTxt('')}}
                            </template>
                        </el-table-column>
                        <el-table-column prop="Model" :label="i18ns.server.model">
                            <template slot-scope="scope">{{scope.row.Model?scope.row.Model:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="" :label="i18ns.server.frequency1">
                            <template slot-scope="scope">{{scope.row.Oem.Huawei.FrequencyMHz+'MHz'}}</template>
                        </el-table-column>
                        <el-table-column prop="Manufacturer" :label="i18ns.server.manufacturer">
                            <template
                                slot-scope="scope">{{scope.row.Manufacturer?scope.row.Manufacturer:'--'}}</template>
                        </el-table-column>
                    </el-table>
                </el-collapse-item>
                <!-- 内存 -->
                <el-collapse-item :title="i18ns.server.memory" name="memory">
                    <el-table :data="memoryList" border style="width:100%;" v-loading="memoryLoading"
                        :element-loading-text="i18ns.common.loading" header-row-class-name="my_table_header">
                        <el-table-column prop="Name" :label="i18ns.server.name">
                            <template slot-scope="scope">{{scope.row.Name?scope.row.Name:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="" :label="i18ns.server.healthStatus">
                            <template slot-scope="scope">
                                {{scope.row.Status?getHealthStausTxt(scope.row.Status.Health):getHealthStausTxt('')}}
                            </template>
                        </el-table-column>
                        <el-table-column prop="Status.State" :label="i18ns.server.positionStatus">
                            <template slot-scope="scope">
                                {{scope.row.Status?getPositionStatusTxt(scope.row.Status.State):getPositionStatusTxt('')}}
                            </template>
                        </el-table-column>
                        <el-table-column prop="CapacityGiB" :label="i18ns.server.capacity">
                            <template slot-scope="scope">{{scope.row.CapacityGiB+'GB'}}</template>
                        </el-table-column>
                        <el-table-column prop="OperatingSpeedMhz" :label="i18ns.server.frequency">
                            <template slot-scope="scope">{{scope.row.OperatingSpeedMhz+'MHz'}}</template>
                        </el-table-column>
                        <el-table-column prop="MemoryDeviceType" :label="i18ns.server.type">
                            <template
                                slot-scope="scope">{{scope.row.MemoryDeviceType?scope.row.MemoryDeviceType:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="Manufacturer" :label="i18ns.server.manufacturer">
                            <template
                                slot-scope="scope">{{scope.row.Manufacturer?scope.row.Manufacturer:'--'}}</template>
                        </el-table-column>
                    </el-table>
                </el-collapse-item>
                <!-- 硬盘 -->
                <el-collapse-item :title="i18ns.server.disk" name="drive">
                    <el-table :data="driveList" border style="width:100%;" v-loading="driveLoading"
                        :element-loading-text="i18ns.common.loading" header-row-class-name="my_table_header">
                        <el-table-column prop="Name" :label="i18ns.server.name">
                            <template slot-scope="scope">{{scope.row.Name?scope.row.Name:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="" :label="i18ns.server.healthStatus">
                            <template slot-scope="scope">
                                {{scope.row.Status?getHealthStausTxt(scope.row.Status.Health):getHealthStausTxt('')}}
                            </template>
                        </el-table-column>
                        <el-table-column prop="Status.State" :label="i18ns.server.positionStatus">
                            <template slot-scope="scope">
                                {{scope.row.Status?getPositionStatusTxt(scope.row.Status.State):getPositionStatusTxt('')}}
                            </template>
                        </el-table-column>
                        <el-table-column prop="MediaType" :label="i18ns.server.mediaType">
                            <template slot-scope="scope">{{scope.row.MediaType?scope.row.MediaType:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="Model" :label="i18ns.server.model">
                            <template slot-scope="scope">{{scope.row.Model?scope.row.Model:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="Manufacturer" :label="i18ns.server.manufacturer">
                            <template
                                slot-scope="scope">{{scope.row.Manufacturer?scope.row.Manufacturer:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="Revision" :label="i18ns.server.revision">
                            <template slot-scope="scope">{{scope.row.Revision?scope.row.Revision:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="Protocol" :label="i18ns.server.protocol">
                            <template slot-scope="scope">{{scope.row.Protocol?scope.row.Protocol:'--'}}</template>
                        </el-table-column>
                    </el-table>
                </el-collapse-item>
                <!-- 电源 -->
                <el-collapse-item :title="i18ns.server.power" name="power" v-show="isShowFan">
                    <el-table :data="powerList" border style="width:100%;" v-loading="powerLoading"
                        :element-loading-text="i18ns.common.loading" header-row-class-name="my_table_header">
                        <el-table-column prop="Name" :label="i18ns.server.name">
                            <template slot-scope="scope">{{scope.row.Name?scope.row.Name:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="" :label="i18ns.server.healthStatus">
                            <template slot-scope="scope">
                                {{scope.row.Status?getHealthStausTxt(scope.row.Status.Health):getHealthStausTxt('')}}
                            </template>
                        </el-table-column>
                        <el-table-column prop="Status.State" :label="i18ns.server.positionStatus">
                            <template slot-scope="scope">
                                {{scope.row.Status?getPositionStatusTxt(scope.row.Status.State):getPositionStatusTxt('')}}
                            </template>
                        </el-table-column>
                        <el-table-column prop="SerialNumber" :label="i18ns.server.sn">
                            <template
                                slot-scope="scope">{{scope.row.SerialNumber?scope.row.SerialNumber:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="PowerCapacityWatts" :label="i18ns.server.ratedPower">
                            <template slot-scope="scope">{{scope.row.PowerCapacityWatts+'W'}}</template>
                        </el-table-column>
                        <el-table-column prop="PowerSupplyType" :label="i18ns.server.inputMode">
                            <template
                                slot-scope="scope">{{scope.row.PowerSupplyType?scope.row.PowerSupplyType:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="Model" :label="i18ns.server.model">
                            <template slot-scope="scope">{{scope.row.Model?scope.row.Model:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="FirmwareVersion" :label="i18ns.server.firmwareVersion">
                            <template
                                slot-scope="scope">{{scope.row.FirmwareVersion?scope.row.FirmwareVersion:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="Oem.Huawei.Protocol" :label="i18ns.server.protocol">
                            <template
                                slot-scope="scope">{{scope.row.Oem.Huawei.Protocol?scope.row.Oem.Huawei.Protocol:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="Manufacturer" :label="i18ns.server.manufacturer">
                            <template
                                slot-scope="scope">{{scope.row.Manufacturer?scope.row.Manufacturer:'--'}}</template>
                        </el-table-column>
                    </el-table>
                </el-collapse-item>
                <!-- 风扇 -->
                <el-collapse-item :title="i18ns.server.fan" name="fan" v-show="isShowPower">
                    <el-table :data="fanList" border style="width:100%;" v-loading="fanLoading"
                        :element-loading-text="i18ns.common.loading" header-row-class-name="my_table_header">
                        <el-table-column prop="Name" :label="i18ns.server.name">
                            <template slot-scope="scope">{{scope.row.Name?scope.row.Name:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="" :label="i18ns.server.healthStatus">
                            <template slot-scope="scope">
                                {{scope.row.Status?getHealthStausTxt(scope.row.Status.Health):getHealthStausTxt('')}}
                            </template>
                        </el-table-column>
                        <el-table-column prop="Status.State" :label="i18ns.server.positionStatus">
                            <template slot-scope="scope">
                                {{scope.row.Status?getPositionStatusTxt(scope.row.Status.State):getPositionStatusTxt('')}}
                            </template>
                        </el-table-column>
                        <el-table-column prop="PartNumber" :label="i18ns.server.partNumber">
                            <template slot-scope="scope">{{scope.row.PartNumber?scope.row.PartNumber:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="Reading" :label="i18ns.server.rotate">
                            <template slot-scope="scope">{{scope.row.Reading+'RPM'}}</template>
                        </el-table-column>
                    </el-table>
                </el-collapse-item>
                <!-- RAID -->
                <el-collapse-item :title="i18ns.server.raid" name="raid">
                    <el-table :data="RaidList" border style="width:100%;" v-loading="raidLoading"
                        :element-loading-text="i18ns.common.loading" header-row-class-name="my_table_header">
                        <el-table-column prop="Name" :label="i18ns.server.name">
                            <template slot-scope="scope">{{scope.row.Name?scope.row.Name:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="" :label="i18ns.server.healthStatus">
                            <template slot-scope="scope">
                                {{scope.row.Status?getHealthStausTxt(scope.row.Status.Health):getHealthStausTxt('')}}
                            </template>
                        </el-table-column>
                        <!--  <el-table-column prop="Status.State" :label="i18ns.server.positionStatus">
                            <template  slot-scope="scope">
                                {{scope.row.Status?getPositionStatusTxt(scope.row.Status.State):getPositionStatusTxt('')}}
                            </template>
                        </el-table-column> -->
                        <el-table-column prop="Model" :label="i18ns.server.model">
                            <template slot-scope="scope">{{scope.row.Model?scope.row.Model:'--'}}</template>
                        </el-table-column>
                        <!--  <el-table-column prop="Model" label=" 类型"></el-table-column> -->
                        <el-table-column prop="SpeedGbps" :label="i18ns.server.interfaceRate">
                            <template slot-scope="scope">{{scope.row.SpeedGbps?(scope.row.SpeedGbps+'Gbps'):'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="Oem.Huawei.ConfigurationVersion"
                            :label="i18ns.server.configurationVersion">
                            <template
                                slot-scope="scope">{{scope.row.Oem.Huawei.ConfigurationVersion?scope.row.Oem.Huawei.ConfigurationVersion:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="FirmwareVersion" :label="i18ns.server.firmwareVersion">
                            <template
                                slot-scope="scope">{{scope.row.FirmwareVersion?scope.row.FirmwareVersion:'--'}}</template>
                        </el-table-column>
                    </el-table>
                </el-collapse-item>
                <!-- 硬盘 -->
                <el-collapse-item :title="i18ns.server.nic" name="networkAdapter">
                    <el-table :data="networkAdapterList" border style="width:100%;" v-loading="networkAdapterLoading"
                        :element-loading-text="i18ns.common.loading" header-row-class-name="my_table_header">
                        <el-table-column prop="Name" :label="i18ns.server.name">
                            <template slot-scope="scope">{{scope.row.Name?scope.row.Name:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="" :label="i18ns.server.healthStatus">
                            <template slot-scope="scope">
                                {{scope.row.Status?getHealthStausTxt(scope.row.Status.Health):getHealthStausTxt('')}}
                            </template>
                        </el-table-column>
                        <el-table-column prop="Model" :label="i18ns.server.model">
                            <template slot-scope="scope">{{scope.row.Model?scope.row.Model:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="NetworkPort.PortNum" :label="i18ns.server.networkPorts">
                            <template
                                slot-scope="scope">{{scope.row.NetworkPort.PortNum?scope.row.NetworkPort.PortNum:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="Manufacturer" :label="i18ns.server.manufacturer">
                            <template
                                slot-scope="scope">{{scope.row.Manufacturer?scope.row.Manufacturer:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="DriverVersion" :label="i18ns.server.driverVersion">
                            <template
                                slot-scope="scope">{{scope.row.DriverVersion?scope.row.DriverVersion:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="DeviceLocator" :label="i18ns.server.position">
                            <template
                                slot-scope="scope">{{scope.row.DeviceLocator?scope.row.DeviceLocator:'--'}}</template>
                        </el-table-column>
                    </el-table>
                </el-collapse-item>
                <!-- PCIE -->
                <el-collapse-item :title="i18ns.server.pcie" name="PCIe">
                    <el-table :data="PCIeList" border style="width:100%;" v-loading="PCIeLoading"
                        :element-loading-text="i18ns.common.loading" header-row-class-name="my_table_header">
                        <el-table-column prop="Name" :label="i18ns.server.name">
                            <template slot-scope="scope">{{scope.row.Name?scope.row.Name:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="" :label="i18ns.server.healthStatus">
                            <template slot-scope="scope">
                                {{scope.row.Status?getHealthStausTxt(scope.row.Status.Health):getHealthStausTxt('')}}
                            </template>
                        </el-table-column>
                        <!-- <el-table-column prop="Status.State" :label="i18ns.server.positionStatus">
                            <template  slot-scope="scope">
                                {{scope.row.Status?getPositionStatusTxt(scope.row.Status.State):getPositionStatusTxt('')}}
                            </template>
                        </el-table-column> -->
                        <el-table-column prop="Model" :label="i18ns.server.model">
                            <template slot-scope="scope">{{scope.row.Model?scope.row.Model:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="Manufacturer" :label="i18ns.server.manufacturer">
                            <template
                                slot-scope="scope">{{scope.row.Manufacturer?scope.row.Manufacturer:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="Oem.Huawei.FunctionType" :label="i18ns.server.functionType">
                            <template
                                slot-scope="scope">{{scope.row.Oem.Huawei.FunctionType?scope.row.Oem.Huawei.FunctionType:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="FirmwareVersion" :label="i18ns.server.firmwareVersion">
                            <template
                                slot-scope="scope">{{scope.row.FirmwareVersion?scope.row.FirmwareVersion:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="Oem.Huawei.Position" :label="i18ns.server.position">
                            <template
                                slot-scope="scope">{{scope.row.Oem.Huawei.Position?scope.row.Oem.Huawei.Position:'--'}}</template>
                        </el-table-column>
                        <el-table-column prop="Description" :label="i18ns.server.desc">
                            <template slot-scope="scope">{{scope.row.Description?scope.row.Description:'--'}}</template>
                        </el-table-column>
                    </el-table>
                </el-collapse-item>
            </el-collapse>
        </el-row>
        <el-row>
            <!-- 返回按钮 -->
            <el-button style="margin-top:10px;" @click="back">{{i18ns.common.back}}</el-button>
        </el-row>
    </div>
    <script>
        var app = new Vue({
            el: '#app',
            data: {
                i18ns: [],
                FDs: [],
                FDIp: '',
                deviceId: '',
                dialogVisible: false,
                loading: false,
                cpuLoading: false,
                memoryLoading: false,
                powerLoading: false,
                fanLoading: false,
                driveLoading: false,
                networkAdapterLoading: false,
                PCIeLoading: false,
                raidLoading: false,
                fullscreenLoading: false,
                severInfo: {},
                activeNames: [],
                cpuList: [],
                memoryList: [],
                powerList: [],
                fanList: [],
                driveList: [],
                networkAdapterList: [],
                PCIeList: [],
                RaidList: [],
                isShowFan: false,
                isShowPower: false,
                cpuHealthState: {
                    normal: 0,
                    warning: 0,
                    critical: 0,
                    unknown: 0
                },
                memoryHealthState: {
                    normal: 0,
                    warning: 0,
                    critical: 0,
                    unknown: 0
                },
                driveHealthState: {
                    normal: 0,
                    warning: 0,
                    critical: 0,
                    unknown: 0
                },
                fanHealthState: {
                    normal: 0,
                    warning: 0,
                    critical: 0,
                    unknown: 0
                },
                powerHealthState: {
                    normal: 0,
                    warning: 0,
                    critical: 0,
                    unknown: 0
                },
            },
            computed: {
                isShowCPUChart: function () {
                    return (this.cpuHealthState.normal + this.cpuHealthState.warning + this.cpuHealthState
                        .critical +
                        this.cpuHealthState.unknown) > 0;
                },
                isShowMemoryChart: function () {
                    return (this.memoryHealthState.normal + this.memoryHealthState.warning + this
                        .memoryHealthState
                        .critical +
                        this.memoryHealthState.unknown) > 0;
                },
                isShowDriveChart: function () {
                    return (this.driveHealthState.normal + this.driveHealthState.warning + this
                        .driveHealthState
                        .critical +
                        this.driveHealthState.unknown) > 0;
                },
                isShowFanChart: function () {
                    return (this.fanHealthState.normal + this.fanHealthState.warning + this.fanHealthState
                        .critical +
                        this.fanHealthState.unknown) > 0;
                },
                isShowPowerChart: function () {
                    return (this.powerHealthState.normal + this.powerHealthState.warning + this
                        .powerHealthState
                        .critical +
                        this.powerHealthState.unknown) > 0;
                }

            },
            created: function () {
                this.i18ns = getIn18();
                this.FDIp = getCurrentFD();
                this.deviceId = getQueryString('id');
                sessionStorage.removeItem('Basic')
                sessionStorage.removeItem('Basic-codeDate')
            },
            mounted: function () {
                Vue.nextTick(function () {
                    app.getBasicInfo();
                    app.getCatalogue();
                    app.getCpuList();
                    app.getMemoryList();
                    app.getDriveList();
                    app.getNetworkAdapterList();
                    app.getPCIeList();
                    app.getRaidList();
                })
            },
            methods: {
                /**
                 * 获取服务器健康状态
                 **/
                getServerStatusTxt: function (healthStatus) {
                    return getServerStatusTxt(healthStatus);
                },

                /**
                 *  返回按钮方法 
                 * **/
                back: function () {
                    window.location.href = '../server/list.html?s=' + Math.random()
                },

                /**
                 * 获取设备健康状态
                 **/
                getHealthStausTxt: function (status) {
                    return getHealthStatusTxt(status);
                },

                /**
                 * 设备在位状态
                 **/
                getPositionStatusTxt: function (status) {
                    return getPositionStatusTxt(status);
                },

                /**
                 * 获取服务器基本信息
                 */
                getBasicInfo: function () {
                    console.log(this.deviceId);
                    this.fullscreenLoading = true;
                    var param = {
                        ip: this.FDIp,
                        deviceId: this.deviceId
                    }
                    serverManage.getBasicInfo(param, function (ret) {
                        setTimeout(function () {
                            app.fullscreenLoading = false;
                        }, intervalTime); //延迟关闭loading
                        if (ret.code === '0') {
                            app.severInfo = ret.data[0].data;
                        } else {
                            // if (ret.ip != app.FDIp) {
                            //     return false
                            // }
                            // var msg = getErrorMsg(ret);
                            // alertMsg(msg);
                            alertErrMsg(ret, 'Basic');
                        }
                    })
                },

                /**
                 * 获取服务器目录
                 */

                getCatalogue: function () {
                    var param = {
                        ip: this.FDIp,
                        deviceId: this.deviceId
                    }
                    serverManage.getCatalogue(param, function (ret) {
                        if (ret.code === '0') {
                            if (ret.data[0].data.Thermal.Count > 0) {
                                app.getFanList();
                                app.isShowFan = true;
                            }
                            if (ret.data[0].data.Power.Count > 0) {
                                app.getPowerList();
                                app.isShowPower = true;
                            }
                        } else {
                            // if (ret.ip != app.FDIp) {
                            //     return false
                            // }
                            // var msg = getErrorMsg(ret);
                            // alertMsg(msg);
                            alertErrMsg(ret, 'Basic');
                        }
                    })
                },

                /**
                 * 获取Cpu集合
                 */
                getCpuList: function () {
                    var param = {
                        ip: this.FDIp,
                        deviceId: this.deviceId
                    }
                    this.cpuLoading = true;
                    serverManage.getCupList(param, function (ret) {
                        app.cpuLoading = false;
                        if (ret.code === '0') {
                            var members = _.filter(ret.data[0].data.Members, function (item) {
                                return item.Status.State != 'Absent';
                            });
                            app.cpuList = ret.data[0].data.Members;
                            for (var i = 0; i < members.length; i++) {
                                var status = members[i].Status;
                                if (status && status.Health) {
                                    if (status.Health.toLowerCase() == 'ok') {
                                        app.cpuHealthState.normal += 1;
                                    } else if (status.Health.toLowerCase() == 'warning') {
                                        app.cpuHealthState.warning += 1;
                                    } else if (status.Health.toLowerCase() == 'critical') {
                                        app.cpuHealthState.critical += 1;
                                    } else {
                                        app.cpuHealthState.unknown += 1;
                                    }
                                } else {
                                    app.cpuHealthState.unknown += 1;
                                }
                            }
                            app.draw('cpu', app.cpuHealthState);

                        } else {
                            app.draw('cpu', app.cpuHealthState);
                            /*  var msg = getErrorMsg(ret);
                             alertMsg(msg); */
                        }
                    })
                },

                /**
                 * 获取内存集合
                 */
                getMemoryList: function () {
                    var param = {
                        ip: this.FDIp,
                        deviceId: this.deviceId
                    }
                    this.memoryLoading = true;
                    serverManage.getMemoryList(param, function (ret) {
                        app.memoryLoading = false;
                        if (ret.code === '0') {
                            var members = _.filter(ret.data[0].data.Members, function (item) {
                                return item.Status.State != 'Absent';
                            });
                            app.memoryList = ret.data[0].data.Members;
                            for (var i = 0; i < members.length; i++) {
                                var status = members[i].Status;
                                if (status && status.Health) {
                                    if (status.Health.toLowerCase() == 'ok') {
                                        app.memoryHealthState.normal += 1;
                                    } else if (status.Health.toLowerCase() == 'warning') {
                                        app.memoryHealthState.warning += 1;
                                    } else if (status.Health.toLowerCase() == 'critical') {
                                        app.memoryHealthState.critical += 1;
                                    } else {
                                        app.memoryHealthState.unknown += 1;
                                    }
                                } else {
                                    app.memoryHealthState.unknown += 1;
                                }
                            }
                            app.draw('memory', app.memoryHealthState);
                        } else {
                            app.draw('memory', app.memoryHealthState);
                            /* var msg = getErrorMsg(ret);
                            alertMsg(msg); */
                        }
                    })
                },

                /**
                 * 获取电源集合
                 */
                getPowerList: function () {
                    var param = {
                        ip: this.FDIp,
                        deviceId: this.deviceId
                    }
                    this.powerLoading = true;
                    serverManage.getPowerList(param, function (ret) {
                        app.powerLoading = false;
                        if (ret.code === '0') {
                            var members = _.filter(ret.data[0].data.PowerSupplies, function (item) {
                                return item.Status.State != 'Absent';
                            });
                            app.powerList = ret.data[0].data.PowerSupplies;
                            for (var i = 0; i < members.length; i++) {
                                var status = members[i].Status;
                                if (status && status.Health) {
                                    if (status.Health.toLowerCase() == 'ok') {
                                        app.powerHealthState.normal += 1;
                                    } else if (status.Health.toLowerCase() == 'warning') {
                                        app.powerHealthState.warning += 1;
                                    } else if (status.Health.toLowerCase() == 'critical') {
                                        app.powerHealthState.critical += 1;
                                    } else {
                                        app.powerHealthState.unknown += 1;
                                    }
                                } else {
                                    app.powerHealthState.unknown += 1;
                                }
                            }
                            app.draw('power', app.powerHealthState);
                        } else {
                            app.draw('power', app.powerHealthState);
                            /*   var msg = getErrorMsg(ret);
                              alertMsg(msg); */
                        }
                    })
                },

                /**
                 * 获取风扇集合
                 */
                getFanList: function () {
                    var param = {
                        ip: this.FDIp,
                        deviceId: this.deviceId
                    }
                    this.fanLoading = true;
                    serverManage.getFanList(param, function (ret) {
                        app.fanLoading = false;
                        if (ret.code === '0') {
                            var members = _.filter(ret.data[0].data.Fans, function (item) {
                                return item.Status.State != 'Absent';
                            });
                            app.fanList = ret.data[0].data.Fans;
                            for (var i = 0; i < members.length; i++) {
                                var status = members[i].Status;
                                if (status && status.Health) {
                                    if (status.Health.toLowerCase() == 'ok') {
                                        app.fanHealthState.normal += 1;
                                    } else if (status.Health.toLowerCase() == 'warning') {
                                        app.fanHealthState.warning += 1;
                                    } else if (status.Health.toLowerCase() == 'critical') {
                                        app.fanHealthState.critical += 1;
                                    } else {
                                        app.fanHealthState.unknown += 1;
                                    }
                                } else {
                                    app.fanHealthState.unknown += 1;
                                }
                            }
                            app.draw('fan', app.fanHealthState);
                        } else {
                            app.draw('fan', app.fanHealthState);
                            /* var msg = getErrorMsg(ret);
                            alertMsg(msg); */
                        }
                    })
                },

                /**
                 * 获取硬盘集合
                 */
                getDriveList: function () {
                    var param = {
                        ip: this.FDIp,
                        deviceId: this.deviceId
                    }
                    this.driveLoading = true;
                    serverManage.getDriveList(param, function (ret) {

                        if (ret.code === '0') {
                            k = ret.data[0].data.Members.length;
                            for (var i = 0; i < ret.data[0].data.Members.length; i++) {
                                (function (arg) {
                                    serverManage.getOneDrive({
                                        ip: app.FDIp,
                                        deviceId: app.deviceId,
                                        driveId: arg.DeviceID
                                    }, function (ret) {
                                        k--;
                                        if (ret.code === '0') {
                                            app.driveList.push(ret.data[0].data);
                                        } else {
                                            /* var msg = getErrorMsg(ret);
                                            alertMsg(msg); */
                                        }
                                    });

                                })(ret.data[0].data.Members[i]);
                            };
                            var mysetInterval = setInterval(function () {
                                if (k == 0) {
                                    app.driveLoading = false;
                                    var members = _.filter(app.driveList, function (
                                        item) {
                                        return item.Status.State != 'Absent';
                                    });
                                    for (var i = 0; i < members.length; i++) {
                                        var status = members[i].Status;
                                        if (status && status.Health) {
                                            if (status.Health.toLowerCase() == 'ok') {
                                                app.driveHealthState.normal += 1;
                                            } else if (status.Health.toLowerCase() ==
                                                'warning') {
                                                app.driveHealthState.warning += 1;
                                            } else if (status.Health.toLowerCase() ==
                                                'critical') {
                                                app.driveHealthState.critical += 1;
                                            } else {
                                                app.driveHealthState.unknown += 1;
                                            }
                                        } else {
                                            app.driveHealthState.unknown += 1;
                                        }
                                    }
                                    app.draw('drive', app.driveHealthState);
                                    window.clearInterval(mysetInterval);
                                }
                            }, 100)
                        } else {
                            app.draw('drive', app.driveHealthState);
                            /*  var msg = getErrorMsg(ret);
                             alertMsg(msg); */
                        }
                    })
                },

                /**
                 * 获取网卡集合
                 */
                getNetworkAdapterList: function () {
                    var param = {
                        ip: this.FDIp,
                        deviceId: this.deviceId
                    }
                    this.networkAdapterLoading = true;
                    serverManage.getNetworkAdapterList(param, function (ret) {
                        app.networkAdapterLoading = false;
                        if (ret.code === '0') {
                            app.networkAdapterList = ret.data[0].data.Members;
                        } else {
                            /* var msg = getErrorMsg(ret);
                            alertMsg(msg); */
                        }
                    })
                },

                /**
                 * 获取PCIe集合
                 */
                getPCIeList: function () {
                    var param = {
                        ip: this.FDIp,
                        deviceId: this.deviceId
                    }
                    this.PCIeLoading = true;
                    serverManage.getPCIeList(param, function (ret) {
                        app.PCIeLoading = false;
                        if (ret.code === '0') {
                            app.PCIeList = ret.data[0].data.Members;
                        } else {
                            /*   var msg = getErrorMsg(ret);
                              alertMsg(msg); */
                        }
                    })
                },

                /**
                 * 获取RAID集合
                 */
                getRaidList: function () {
                    var param = {
                        ip: this.FDIp,
                        deviceId: this.deviceId
                    }
                    this.raidLoading = true;
                    serverManage.getRaidList(param, function (ret) {
                        if (ret.code === '0') {
                            for (var i = 0; i < ret.data[0].data.Members.length; i++) {
                                (function (arg) {
                                    serverManage.getOneRaid({
                                        ip: app.FDIp,
                                        deviceId: app.deviceId,
                                        raidId: arg.DeviceID
                                    }, function (ret) {
                                        app.raidLoading = false;
                                        if (ret.code === '0') {
                                            var members = ret.data[0].data
                                                .StorageControllers;
                                            for (var i = 0; i < members.length; i++) {
                                                app.RaidList.push(members[i]);
                                            }
                                        } else {
                                            /*   var msg = getErrorMsg(ret);
                                              alertMsg(msg); */
                                        }
                                    });

                                })(ret.data[0].data.Members[i])
                            };
                            if (ret.data[0].data.Members.length == 0) {
                                app.raidLoading = false;
                            }
                        } else {
                            app.raidLoading = false;
                            /*   var msg = getErrorMsg(ret);
                              alertMsg(msg); */
                        }
                    })
                },

                /**
                 * 绘制饼状图的方法
                 * **/
                draw: function (id, data) {
                    var ctx = document.getElementById(id);
                    if ((data.normal + data.warning + data.critical + data.unknown) > 0) {
                        var myPieChart = new Chart(ctx, {
                            type: 'doughnut',
                            data: {
                                datasets: [{
                                    data: [data.normal, data.warning, data.critical, data
                                        .unknown
                                    ],
                                    backgroundColor: [
                                        '#32CD32',
                                        '#FFBB33',
                                        '#FF0000',
                                        '#4169E1'
                                    ],
                                    borderWidth: [0, 0, 0]
                                }],
                                labels: [
                                    'normal',
                                    'Warning',
                                    'Critical',
                                    'unknown'
                                ]
                            },
                            options: {
                                cutoutPercentage: 80,
                                tooltips: {},
                                legend: {
                                    display: false
                                }
                            }
                        });
                    } else {
                        var myCanvas = document.getElementById(id + "_noRecords");
                        var context = myCanvas.getContext("2d");
                        var center_x = myCanvas.width / 2;
                        var center_y = myCanvas.height / 2;
                        var rad = Math.PI * 2 / 100;
                        // 绘制背景圆圈
                        function backgroundCircle() {
                            context.save();
                            context.beginPath();
                            context.lineWidth = 12; //设置线宽
                            var radius = center_x - context.lineWidth;
                            context.lineCap = "round";
                            context.strokeStyle = '#ccc';
                            context.arc(center_x, center_y, radius, 0, Math.PI * 2, false);
                            context.stroke();
                            context.closePath();
                            context.restore();
                        }
                        //绘制文字
                        function text(n) {
                            context.save(); //save和restore可以保证样式属性只运用于该段canvas元素
                            context.fillStyle = '#000';
                            var font_size = 14;
                            context.font = font_size + "px Helvetica";
                            var title = '';
                            switch (id) {
                                case 'cpu':
                                    title = app.i18ns.server.cpu;
                                    break;
                                case 'memory':
                                    title = app.i18ns.server.memory;
                                    break;
                                case 'drive':
                                    title = app.i18ns.server.disk;
                                    break;
                                case 'fan':
                                    title = app.i18ns.server.fan;
                                    break;
                                case 'power':
                                    title = app.i18ns.server.power;
                                    break;
                                default:
                                    break;
                            }
                            var text_width1 = context.measureText(title).width;
                            var text_width2 = context.measureText(n).width;
                            context.fillText(title, center_x - text_width1 / 2, center_y - font_size);
                            context.fillText(n, center_x - text_width2 / 2, center_y + font_size);
                            context.restore();
                        }
                        backgroundCircle();
                        text(this.i18ns.server.NoRecord);
                    }
                },

                /**
                 * 上下电操作
                 */
                reset: function (type) {
                    if (type == 'On') {
                        var param = {
                            ip: this.FDIp,
                            data: {
                                "ResetType": "ForceOff",
                                "DeviceIDs": [this.deviceId]
                            }
                        }
                        serverManage.computerReset(param, function (ret) {
                            if (ret.code === '0') {
                                app.dialogVisible = false;
                                app.$alert(app.i18ns.server.server_powerOffWaitingTip, app.i18ns
                                    .prompt, {
                                        confirmButtonText: app.i18ns.confirm,
                                    });
                                var headers = ret.headers;
                                if (headers && headers.task) {
                                    var task = headers.task[0];
                                    var taskId = task.substr(task.lastIndexOf('/') + 1)
                                    var mysetInterval = setInterval(function () {
                                        serverManage.tasks({
                                            ip: app.FDIp,
                                            taskId: taskId
                                        }, function (res) {
                                            if (res.code == 0) {
                                                if (res.data[0].data.Status ==
                                                    'Finish') {
                                                    window.clearInterval(
                                                        mysetInterval);
                                                    app.severInfo.PowerState =
                                                        'Off';
                                                    app.$message({
                                                        message: app.i18ns
                                                            .server
                                                            .server_powerOffSuccessTip,
                                                        type: 'success'
                                                    });
                                                }
                                                if (res.data[0].data.Status ==
                                                    'Failed') {
                                                    window.clearInterval(
                                                        mysetInterval);
                                                    app.$message({
                                                        message: app.i18ns
                                                            .server
                                                            .server_powerOffFailTip,
                                                        type: 'success'
                                                    });
                                                }

                                            }
                                        });
                                    }, 1000);
                                }
                            } else {
                                if (ret.ip != app.FDIp) {
                                    return false
                                }
                                msg = getErrorMsg(ret);
                                alertMsg(msg);
                            }
                        })
                    } else {
                        var param = {
                            ip: this.FDIp,
                            data: {
                                "ResetType": "On",
                                "DeviceIDs": [this.deviceId]
                            }
                        }
                        serverManage.computerReset(param, function (ret) {
                            if (ret.code === '0') {
                                app.dialogVisible = false;
                                app.$alert(app.i18ns.server.server_powerOnWaitingTip, app.i18ns
                                    .prompt, {
                                        confirmButtonText: app.i18ns.confirm,
                                    });
                                var headers = ret.headers;
                                if (headers && headers.task) {
                                    var task = headers.task[0];
                                    var taskId = task.substr(task.lastIndexOf('/') + 1)
                                    var mysetInterval = setInterval(function () {
                                        serverManage.tasks({
                                            ip: app.FDIp,
                                            taskId: taskId
                                        }, function (res) {
                                            if (res.code == 0) {
                                                if (res.data[0].data.Status ==
                                                    'Finish') {
                                                    window.clearInterval(
                                                        mysetInterval);
                                                    app.severInfo.PowerState =
                                                        'On';
                                                    app.$message({
                                                        message: app.i18ns
                                                            .server
                                                            .server_powerOnSuccessTip,
                                                        type: 'success'
                                                    });
                                                }
                                            }
                                            if (res.data[0].data.Status ==
                                                'Failed') {
                                                window.clearInterval(
                                                    mysetInterval);
                                                app.$message({
                                                    message: app.i18ns
                                                        .server
                                                        .server_powerOnFailTip,
                                                    type: 'success'
                                                });
                                            }
                                        });
                                    }, 1000);
                                }
                            } else {
                                if (ret.ip != app.FDIp) {
                                    return false
                                }
                                msg = getErrorMsg(ret);
                                alertMsg(msg);
                            }
                        })
                    }
                }
            }
        });
    </script>
</body>

</html>